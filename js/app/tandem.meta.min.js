!function(P,n,R){let O=["FORM_ONE","FORM_ONE_ADV","FORM_ONE_PO","FORM_TWO","FORM_TWO_NOUN_COMP","FORM_TWO_GER_COMP","FORM_TWO_ADJ_COMP","FORM_TWO_TO_COMP","FORM_TWO_PREP_COMP","FORM_TWO_NCLS_COMP","FORM_THREE","FORM_THREE_ADV","FORM_THREE_NOUN_OBJ","FORM_THREE_GER_OBJ","FORM_THREE_TO_OBJ","FORM_THREE_INTERR_OBJ","FORM_THREE_NCLS_OBJ","FORM_FOUR","FORM_FIVE","FORM_FIVE_NOUN_OC","FORM_FIVE_GER_OC","FORM_FIVE_ADJ_OC","FORM_FIVE_AP_OC","FORM_FIVE_PP_OC","FORM_FIVE_TO_OC","FORM_FIVE_RV_OC","FORM_FIVE_INTERR_OBJ","FORM_FIVE_PREP_OC","CLAUSE","CCLS","CCLS_FOR","CCLS_BESIDE","CCLS_YET","CCLS_NOR","NCLS","NCLS_SUBJ","NCLS_ACTUAL_SUBJ","NCLS_ACTUAL_OBJ","NCLS_OBJ","NCLS_COMP","NCLS_TO_OBJ","NCLS_GER_OBJ","NCLS_PTC_OBJ","NCLS_APPO","NCLS_INTERR_SUBJ","NCLS_INTERR_ACTUAL_SUBJ","NCLS_INTERR_ACTUAL_OBJ","NCLS_INTERR_OBJ","NCLS_INTERR_COMP","NCLS_INTERR_TO_OBJ","NCLS_INTERR_GER_OBJ","NCLS_INTERR_PTC_OBJ","NCLS_NRP","NCLS_NRP_SUBJ","NCLS_NRP_ACTUAL_SUBJ","NCLS_NRP_ACTUAL_OBJ","NCLS_NRP_OBJ","NCLS_NRP_COMP","NCLS_NRP_TO_OBJ","NCLS_NRP_GER_OBJ","NCLS_NRP_PTC_OBJ","NCLS_NCLC","NCLS_NCLC_SUBJ","NCLS_NCLC_ACTUAL_SUBJ","NCLS_NCLC_ACTUAL_OBJ","NCLS_NCLC_OBJ","NCLS_NCLC_COMP","NCLS_NCLC_TO_OBJ","NCLS_NCLC_GER_OBJ","NCLS_NCLC_PTC_OBJ","ACLS","ACLS_WHO","ACLS_WHO_SUBJ","ACLS_WHO_OBJ","ACLS_WHO_COMP","ACLS_WHOSE","ACLS_WHOM","ACLS_WHOM_SUBJ","ACLS_WHOM_OBJ","ACLS_WHOM_COMP","ACLS_WHOM_PO","ACLS_WHICH","ACLS_WHICH_SUBJ","ACLS_WHICH_OBJ","ACLS_WHICH_COMP","ACLS_WHICH_PO","ACLS_THAT","ACLS_THAT_SUBJ","ACLS_THAT_OBJ","ACLS_THAT_COMP","ACLS_THAT_PO","ADVCLS","ADVCLS_IF","ADVCLS_UNLESS","ADVCLS_WHEN","ADVCLS_WHILE","ADVCLS_UNTIL","ADVCLS_BEFORE","ADVCLS_AFTER","ADVCLS_BECAUSE","ADVCLS_SINCE","ADVCLS_THOUGH","ADVCLS_ALTHOUGH","ADVCLS_EVEN_THOUGH","ADVCLS_SO_THAT","ADVCLS_SUCH_THAT","ADVCLS_AS","ADVCLS_AS_IF","ADVCLS_WHERE","PCLS","TO","TO_SUBJ","TO_OBJ","TO_ACTUAL_SUBJ","TO_ACTUAL_OBJ","TO_COMP","TO_ADJ","TO_ADV","GER","GER_SUBJ","GER_SUBJ_PP","GER_OBJ","GER_ACTUAL_OBJ","GER_COMP","PTC","AP","AP_OC","AP_COMP","PP","PP_OC","PP_COMP","SENSE_OBJ","SENSE_SUBJ","ACTUAL_SUBJ","ACTUAL_OBJ","MODI","MODI_POST_AP","MODI_PRE_AP","MODI_POST_PP","MODI_POST_TO","MODI_POST_PREP","MODI_PRE_ADJ","INTERR","INTERR_SUBJ","INTERR_OBJ","INTERR_COMP","PREP_ADJ","PREP_ADVBIAL","PREP_OBJ_ADVBIAL","PHR","PHR_ABOARD","PHR_ABOUT","PHR_ABOVE","PHR_ACCORDING","PHR_ACROSS","PHR_AFTER","PHR_AGAINST","PHR_AHEAD_OF","PHR_ALONG","PHR_ALONG_WITH","PHR_ALONGSIDE","PHR_AMID","PHR_AMIDST","PHR_AMONG","PHR_AMONGST","PHR_ANTI","PHR_APART_FROM","PHR_AROUND","PHR_AS","PHR_AS_FOR","PHR_AS_PER","PHR_AS_TO","PHR_AS_WELL_AS","PHR_AS_OF","PHR_ASIDE","PHR_ASTRIDE","PHR_AT","PHR_ATOP","PHR_AWAY_FROM","PHR_BAR","PHR_BARRING","PHR_BECAUSE_OF","PHR_BEFORE","PHR_BEHIND","PHR_BELOW","PHR_BENEATH","PHR_BESIDE","PHR_BESIDES","PHR_BETWEEN","PHR_BEYOND","PHR_BUT","PHR_BUT_FOR","PHR_BY","PHR_BY_MEANS_OF","PHR_CIRCA","PHR_CLOSE_TO","PHR_CONCERNING","PHR_CONSIDERING","PHR_CONTRARY_TO","PHR_COUNTING","PHR_CUM","PHR_DESPITE","PHR_DEPENDING_ON","PHR_DOWN","PHR_DUE_TO","PHR_DURING","PHR_EXCEPT","PHR_EXCEPT_FOR","PHR_EXCEPTING","PHR_EXCLUDING","PHR_FOLLOWING","PHR_FOR","PHR_FORWARD_OF","PHR_FROM","PHR_FURTHER_TO","PHR_GIVEN","PHR_GONE","PHR_IN","PHR_IN_ADDITION_TO","PHR_IN_BETWEEN","PHR_IN_CASE_OF","PHR_IN_FACE_OF","PHR_IN_FAVOUR_OF","PHR_IN_FRONT_OF","PHR_IN_LIEU_OF","PHR_IN_SPITE_OF","PHR_IN_VIEW_OF","PHR_INTO","PHR_INCLUDING","PHR_INSIDE","PHR_INSTEAD_OF","PHR_LESS","PHR_LIKE","PHR_MINUS","PHR_NEAR","PHR_NEAR_TO","PHR_NEXT_TO","PHR_NOTWITHSTANDING","PHR_OF","PHR_OFF","PHR_ON","PHR_ON_ACCOUNT_OF","PHR_ON_BEHALF_OF","PHR_ON_BOARD","PHR_ON_TO","PHR_ONTO","PHR_ON_TOP_OF","PHR_OPPOSITE","PHR_OPPOSITE_TO","PHR_OTHER_THAN","PHR_OUT","PHR_OUT_OF","PHR_OUTSIDE","PHR_OUTSIDE_OF","PHR_OVER","PHR_OWING_TO","PHR_PAST","PHR_PENDING","PHR_PER","PHR_PLUS","PHR_PREPARATORY_TO","PHR_PRIOR_TO","PHR_PRO","PHR_RE","PHR_REGARDING","PHR_REGARDLESS_OF","PHR_RESPECTING","PHR_ROUND","PHR_SAVE","PHR_SAVE_FOR","PHR_SAVING","PHR_SINCE","PHR_THROUGH","PHR_THRU","PHR_THROUGHOUT","PHR_TILL","PHR_TO","PHR_TOGETHER_WITH","PHR_TOUCHING","PHR_TOWARD","PHR_TOWARDS","PHR_THAN","PHR_THANKS_TO","PHR_UNDER","PHR_UNDERNEATH","PHR_UNLIKE","PHR_UNTIL","PHR_UNTO","PHR_UP","PHR_UP_AGAINST","PHR_UP_TO","PHR_UP_UNTIL","PHR_UPON","PHR_VERSUS","PHR_VIA","PHR_WITH","PHR_WITH_REFERENCE_TO","PHR_WITH_REGARD_TO","PHR_WITHOUT","PHR_WITHIN","VERB_PHR","CLEFT_IT"],r=["s","ss","v","o","po","c","a","oc","m","rcm","tor","to","ger","go","ptc","ptco","appo","conj","phr","adjphr","advphr","ptcphr","cls","ncls","acls","advcls","ccls","pcls","cleft"],C=["s","v","o","po","c","a","oc","m","to","go","ptco","appo"],a=["who","whose","whom","which","that"],o=["if","unless","when","while","until","before","after","because","since","though","although","even though","so that","such that","as if","as","where"],H=["for","beside","yet","nor"],s=["aboard","about","above","according","across","after","against","ahead of","along with","alongside","along","amidst","amid","amongst","among","anti","apart from","around","as for","as per","as to","as well as","as of","aside","astride","as","atop","at","away from","barring","bar","because of","before","behind","below","beneath","besides","beside","between","beyond","but for","but","by means of","by","circa","close to","concerning","considering","contrary to","counting","cum","despite","depending on","down","due to","during","except for","excepting","except","excluding","following","forward of","for","from","further to","given","gone","in addition to","in between","in case of","in face of","in favour of","in front of","in lieu of","in spite of","in view of","into","including","inside","instead of","in","less","like","minus","near to","near","next to","notwithstanding","off","of","on account of","on behalf of","on board","on to","onto","on top of","on","opposite to","opposite","other than","out of","out","outside of","outside","over","owing to","past","pending","per","plus","preparatory to","prior to","pro","re","regarding","regardless of","respecting","round","save","save for","saving","since","through","thru","throughout","till","together with","touching","toward","towards","to","than","thanks to","underneath","under","unlike","until","up against","up to","up until","upon","up","versus","via","with reference to","with regard to","without","within","with"];let S="(진)s",E="(진)o";let l="(의)s",T=["i.o.","d.o.",E,S,"(전)o",l];function e(_){return function(_){let e=_.filter(_=>O.includes(_.name)).filter((e,_,t)=>!t.some(_=>_?.name?.startsWith(e.name+"_"))).map(_=>_.name),t=[];return e.forEach(_=>{t.includes(_)||(_.startsWith("FORM")&&!t.some(_=>_.startsWith("+MAIN_"))?t.push("+MAIN_"+_):t.push(_))}),t.sort((_,e)=>{var t=e.length-_.length;return 0==t?_.localeCompare(e):t}).join(" ")}(function O(t,_){let P,a=[],o=_||1;a.some(_=>_.startsWith("FORM"))||(I(t,"role","oc")?P="FORM_FIVE":I(t,"rc","i.o.")?P="FORM_FOUR":I(t,"role","o")?P="FORM_THREE"+(I(t,"role","a")?"_ADV":""):I(t,"role","c")?P="FORM_TWO":I(t,"role","v")&&(P="FORM_ONE"+(I(t,"role","a")?"_ADV":"")),null==P)||I(a,"name",P)||(I(t,"role","po")&&!I(a,"name","FORM_ONE_PO")&&a.push({depth:o+1,name:"FORM_ONE_PO"}),a.push({depth:o+1,name:P}));let r=t.filter(_=>null!=_.pos);for(let n=0,_=r.length;n<_;n++){let _=r[n],e=u[_.role],t=u[_.pos],R=t+"_"+e,O=P?P+"_"+R:R;I(a,"name",O)||a.push({depth:o,name:O}),I(a,"name",R)||a.push({depth:o,name:R}),[E,S].includes(_.rc)&&(a.push({depth:o,name:t+"_ACTUAL_"+(_.rc==E?"OBJ":"SUBJ")}),a.push({depth:o+1,name:"ACTUAL_"+(_.rc==E?"OBJ":"SUBJ")})),I(a,"name",t)||a.push({depth:o+1,name:t}),I(a,"name",e)||a.push({depth:o+1,name:e}),t?.includes("CLS")&&!I(a,"name","CLAUSE")&&a.push({depth:o+1,name:"CLAUSE"}),["AP","PP"].includes(t)&&!I(a,"name","PTC")&&a.push({depth:o+1,name:"PTC"}),_.rc==l&&a.push({depth:o+1,name:"SENSE_SUBJ"})}for(let e=0,_=t.length;e<_;e++){let R=t[e],_=u[R.role];if(R.prep){if("adjphr"==R.role){let _=d("prep adj");I(a,"name",_)||a.push({depth:o+1,name:_})}let _=d("phr "+R.prep);I(a,"name",_)||a.push({depth:o+1,name:_})}else if(R.cc){let _=d("ccls "+R.cc);I(a,"name",_)||a.push({depth:o+1,name:_})}else if(R.rp){let e=R.children?.find(_=>_.text==R.rp)?.role;if(e){let _=d(`acls ${R.rp} `+u[e]);I(a,"name",_)||a.push({depth:o+1,name:_})}else{let _=d("acls "+R.rp);I(a,"name",_)||a.push({depth:o+1,name:_})}}else if(R.adv){let _=d("advcls "+R.adv);I(a,"name",_)||a.push({depth:o+1,name:_})}if(R.modi){let _=d("modi "+R.modi);I(a,"name",_)||a.push({depth:o+1,name:_})}if(I(a,"name",_)||a.push({depth:o+1,name:_}),["AP","PP"].includes(_)&&!I(a,"name","PTC")&&a.push({depth:o+1,name:"PTC"}),R.ptcphr&&a.push({depth:o+1,name:"PTCPHR"}),[E,S].includes(R.rc)&&a.push({depth:o+1,name:"ACTUAL_"+(R.rc==E?"OBJ":"SUBJ")}),R.rc==l&&a.push({depth:o+1,name:"SENSE_SUBJ"}),"cleft"==R.role&&R.text.match(/^[iI]t/)&&a.push({depth:o+1,name:"CLEFT_IT"}),0<R.children.length){let t=O(R.children,o+2);for(let e=0,_=t.length;e<_;e++){let _=t[e];I(a,"name",_.name)||a.push({depth:_.depth,name:_.name})}}}return a}(function a(_){let e=R.cleanSvocDOMs(_);let t=e.children;let o=[];for(let _=0,e=t.length;_<e;_++){let P=t[_],e=P.firstElementChild,R;if(0<P.childElementCount&&e.textContent==P.textContent){let t,n,_;if(n=A(e,C)?(t=e,P):(t=P,e),R=A(t,r),_=A(n,r),R){let O={role:R,pos:_,text:e.textContent,children:a(e)};switch(Object.keys(t.dataset).forEach(_=>{let e=t.dataset[_];"rc"==_&&T.includes(e)&&(O[_]=e)}),O.pos){case"phr":let _=p(n);_&&(O.prep=_);break;case"acls":let e=N(n);e&&(O.rp=e);break;case"advcls":let t=c(n);t&&(O.adv=t);break;case"ptc":let R=h(n);R&&(O.pos=R)}o.push(O)}}else if(R=A(P,r)){let O={role:R,text:P.textContent,children:a(P)};switch(Object.keys(P.dataset).forEach(_=>{let e=P.dataset[_];"rc"==_&&T.includes(e)&&(O[_]=e)}),O.role){case"phr":case"adjphr":let _=p(P);_&&(O.prep=_);break;case"ccls":let e=i(P);e&&(O.cc=e);break;case"ptc":let t=h(P);t&&(O.role=t);break;case"rcm":let R=L(P);R&&(O.modi=R)}o.push(O)}}return o}(_))).replace(/(\bFORM_\w*|\bNCLS\w*|\bADVCLS\w*|\bPCLS\w*|\bCCLS\w*|\bACLS\w*)/g,"+$1")}function A(e,_){return _.find(_=>e.classList.contains(_))}function N(t,_){let R=null;if(null!=_)return null!=t.textContent.match(new RegExp(`\\b${_}\\b`,"gi"));for(let _=0,e=a.length;_<e;_++){let e=a[_];if(t.textContent.match(new RegExp(`\\b${e}\\b`,"gi"))?.length>Array.from(t.querySelectorAll(".acls")).filter(_=>N(_,e)).length){R=e;break}}return R}function c(t){let R=null;for(let _=0,e=o.length;_<e;_++){var O=o[_];if(0<t.textContent.length&&t.textContent.toLowerCase().startsWith(O)){R=O;break}}return R}function i(t){let R=null;for(let _=0,e=H.length;_<e;_++){var O=H[_];if(null!=t.previousSibling&&new RegExp(O+" $","i").test(t.previousSibling.wholeText)){R=O;break}}return R}function p(t){let R=null;for(let _=0,e=s.length;_<e;_++){var O=s[_];if(0<t.textContent.length&&t.textContent.toLowerCase().startsWith(O+" ")){R=O;break}}return R}function h(_){return/^\w+ing\b/.test(_.textContent)?"ap":"pp"}function L(_){var e=n.querySelector(`[data-mfd="${_.className.match(/mfd-(\d+-\d+)/)[1]}"]`),t=e?.closest(".ptc,.adjphr,.tor");let R;switch(t?.className?.match(/ptc|adjphr|tor/)?.[0]){case"adjphr":var O=p(t);R=O?"prep":"adj";break;case"tor":R="to";break;case"ptc":R=h(t)}return R?`${_.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING?"pre":"post"}_`+R:null}let u={s:"SUBJ",v:"VERB",o:"OBJ",po:"PO",c:"COMP",oc:"OC",a:"ADV",m:"MODI",rcm:"MODI",tor:"TO",to:"TO_OBJ",ger:"GER",go:"GER_OBJ",ptc:"PTC",ptco:"PTC_OBJ",appo:"APPO",ap:"AP",pp:"PP",conj:"conj",phr:"PREP",adjphr:"adjphr",advphr:"advphr",ptcphr:"ptcphr",cls:"CLAUSE",ncls:"NCLS",acls:"ACLS",advcls:"ADVCLS",ccls:"CCLS",pcls:"PCLS"};function I(_,e,t){return _.some(_=>_[e]==t)}function d(_){return _.toUpperCase().replaceAll(" ","_")}R.meta={gramMetaStrFromDOM:e,saveGramMetaFromDOM:function(t,_,R,O){let n=e(_);return new Promise((_,e)=>{P.ajax({url:`/${O}/sentence/grammeta/edit`,type:"POST",data:JSON.stringify({sentenceId:t,gramMeta:n,metaStatus:R?"S":"U"}),contentType:"application/json",success:()=>_(n),error:e})})},submitMetaStatus:function(_,e,t,R){P.ajax({url:`/${t}/sentence/metastatus/edit`,type:"POST",data:JSON.stringify({sentenceId:_,metaStatus:e}),contentType:"application/json",success:R,error:()=>alert("분석 평가 중 에러가 발생했습니다.")})}}}(jQuery,document,tandem);