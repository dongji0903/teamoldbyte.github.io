!function(R,n,p){const S=["s","v","o","c","a","oc","m","rcm","tor","ger","ptc","conj","phr","adjphr","advphr","ptcphr","cls","ncls","acls","advcls","ccls","pcls"],C=["s","v","o","c","a","oc","m"],o=["who","whose","whom","which","that"],P=["if","unless","when","while","until","before","after","because","since","though","although","even though","so that","such that","as if","as","where"],O=["for","beside","yet","nor"],a=["aboard","about","above","according","across","after","against","ahead of","along with","alongside","along","amidst","amid","amongst","among","anti","apart from","around","as for","as per","as to","as well as","as of","aside","astride","as","atop","at","away from","barring","bar","because of","before","behind","below","beneath","besides","beside","between","beyond","but for","but","by means of","by","circa","close to","concerning","considering","contrary to","counting","cum","despite","depending on","down","due to","during","except for","excepting","except","excluding","following","forward of","for","from","further to","given","gone","in addition to","in between","in case of","in face of","in favour of","in front of","in lieu of","in spite of","in view of","into","including","inside","instead of","in","less","like","minus","near to","near","next to","notwithstanding","off","of","on account of","on behalf of","on board","on to","onto","on top of","on","opposite to","opposite","other than","out of","out","outside of","outside","over","owing to","past","pending","per","plus","preparatory to","prior to","pro","re","regarding","regardless of","respecting","round","save","save for","saving","since","through","thru","throughout","till","together with","touching","toward","towards","to","than","thanks to","underneath","under","unlike","until","up against","up to","up until","upon","up","versus","via","with reference to","with regard to","without","within","with"];const h="(진)s",u="(진)o",N="prep.o.",d="(의)s",I=["i.o.","d.o.",u,h,N,d];function r(e){return function t(n,e){let R,o=[],P=e||1;B(n,"role","oc")?R="FORM_FIVE":B(n,"rc","i.o.")?R="FORM_FOUR":B(n,"role","o")?R="FORM_THREE":B(n,"role","c")?R="FORM_TWO":B(n,"role","v")&&(R="FORM_ONE"+(B(n,"role","a")?"_ADV":""));null==R||B(o,"name",R)||o.push({depth:P+1,name:R});const O=n.filter(e=>null!=e.pos);for(let t=0,e=O.length;t<e;t++){const a=O[t],r=g[a.role];let e=g[a.pos],_=e+"_"+r;a.rc==N&&(_="VI_PREP");const s=R?R+"_"+_:_;B(o,"name",s)||o.push({depth:P,name:s}),B(o,"name",_)||o.push({depth:P,name:_}),[u,h].includes(a.rc)&&o.push({depth:P,name:e+"_ACTUAL_"+(a.rc==u?"OBJ":"SUBJ")}),B(o,"name",e)||o.push({depth:P+1,name:e}),B(o,"name",r)||o.push({depth:P+1,name:r}),e.includes("CLS")&&!B(o,"name","CLAUSE")&&o.push({depth:P+1,name:"CLAUSE"}),["AP","PP"].includes(e)&&!B(o,"name","PTC")&&o.push({depth:P+1,name:"PTC"}),a.rc==d&&o.push({depth:P+1,name:"SENSE_SUBJ"})}for(let e=0,_=n.length;e<_;e++){const H=n[e],c=g[H.role];if(H.prep){const E=V("phr "+H.prep);B(o,"name",E)||o.push({depth:P+1,name:E})}else if(H.cc){const i=V("ccls "+H.cc);B(o,"name",i)||o.push({depth:P+1,name:i})}else if(H.rp){const T=V("acls "+H.rp);B(o,"name",T)||o.push({depth:P+1,name:T})}else if(H.adv){const l=V("advcls "+H.adv);B(o,"name",l)||o.push({depth:P+1,name:l})}if(H.ptcmodi){const A=V("modi "+H.ptcmodi);B(o,"name",A)||o.push({depth:P+1,name:A})}if(B(o,"name",c)||o.push({depth:P+1,name:c}),["AP","PP"].includes(c)&&!B(o,"name","PTC")&&o.push({depth:P+1,name:"PTC"}),H.ptcphr&&o.push({depth:P+1,name:"PTCPHR"}),H.rc==d&&o.push({depth:P+1,name:"SENSE_SUBJ"}),0<H.children.length){const p=t(H.children,P+2);for(let e=0,_=p.length;e<_;e++){const S=p[e];B(o,"name",S.name)||o.push({depth:S.depth,name:S.name})}}}return o}(function R(e){const _=p.cleanSvocDOMs(e);const t=_.children;let o=[];for(let e=0,_=t.length;e<_;e++){const P=t[e],O=P.firstElementChild;let n;if(0<P.childElementCount&&O.textContent==P.textContent){let t,e,_;if(e=f(O,C)?(t=O,P):(t=P,O),n=f(t,S),_=f(e,S),n){const a={role:n,pos:_,text:O.textContent,children:R(O)};switch(Object.keys(t.dataset).forEach(e=>{const _=t.dataset[e];"rc"==e&&I.includes(_)&&(a[e]=_)}),a.pos){case"phr":const r=D(e);r&&(a.prep=r);break;case"acls":const s=F(e);s&&(a.rp=s);break;case"advcls":const H=m(e);H&&(a.adv=H);break;case"ptc":const c=U(e);c&&(a.pos=c)}o.push(a)}}else if(n=f(P,S)){const E={role:n,text:P.textContent,children:R(P)};switch(Object.keys(P.dataset).forEach(e=>{const _=P.dataset[e];"rc"==e&&I.includes(_)&&(E[e]=_)}),E.role){case"phr":const i=D(P);i&&(E.prep=i);break;case"ccls":const T=L(P);T&&(E.cc=T);break;case"ptc":const l=U(P);l&&(E.role=l);break;case"rcm":const A=M(P);A&&(E.ptcmodi=A)}o.push(E)}}return o}(e)).filter(e=>_.includes(e.name)&&!t.includes(e.name)).sort((e,_)=>e.depth-_.depth).map(e=>e.name).join(" ")}function f(_,e){return e.find(e=>_.classList.contains(e))}function F(t,e){let n=null;if(null!=e)return null!=t.textContent.match(new RegExp(`\\b${e}\\b`,"gi"));for(let e=0,_=o.length;e<_;e++){const R=o[e];if(t.textContent.match(new RegExp(`\\b${R}\\b`,"gi"))?.length>Array.from(t.querySelectorAll(".acls")).filter(e=>F(e,R)).length){n=R;break}}return n}function m(t){let n=null;for(let e=0,_=P.length;e<_;e++){var R=P[e];if(0<t.textContent.length&&t.textContent.toLowerCase().startsWith(R)){n=R;break}}return n}function L(t){let n=null;for(let e=0,_=O.length;e<_;e++){var R=O[e];if(null!=t.previousSibling&&new RegExp(R+" $","i").test(t.previousSibling.wholeText)){n=R;break}}return n}function D(t){let n=null;for(let e=0,_=a.length;e<_;e++){var R=a[e];if(0<t.textContent.length&&t.textContent.toLowerCase().startsWith(R)){n=R;break}}return n}function U(e){return/^\w+ing\b/.test(e.textContent)?"ap":"pp"}function M(e){var _,t=n.querySelector(`[data-mfd="${e.className.match(/mfd-(\d+-\d+)/)[1]}"]`);return t.classList.contains("ptc")?(_=U(t),2&e.compareDocumentPosition(t)?"pre_"+_:"post_"+_):null}const g={s:"SUBJ",v:"VERB",o:"OBJ",c:"COMP",oc:"OC",a:"ADV",m:"MODI",rcm:"MODI",tor:"TO",ger:"GER",ptc:"PTC",ap:"AP",pp:"PP",conj:"conj",phr:"PREP",adjphr:"adjphr",advphr:"advphr",ptcphr:"ptcphr",cls:"CLAUSE",ncls:"NCLS",acls:"ACLS",advcls:"ADVCLS",ccls:"CCLS",pcls:"PCLS"};function B(e,_,t){return e.some(e=>e[_]==t)}function V(e){return e.toUpperCase().replaceAll(" ","_")}const _=["FORM_ONE","FORM_ONE_ADV","FORM_TWO","FORM_TWO_NOUN_COMP","FORM_TWO_GER_COMP","FORM_TWO_ADJ_COMP","FORM_TWO_TO_COMP","FORM_TWO_PREP_COMP","FORM_TWO_NCLS_COMP","FORM_THREE","FORM_THREE_VI_PREP","FORM_THREE_NOUN_OBJ","FORM_THREE_GER_OBJ","FORM_THREE_TO_OBJ","FORM_THREE_INTERR_OBJ","FORM_THREE_NCLS_OBJ","FORM_FOUR","FORM_FIVE","FORM_FIVE_NOUN_OC","FORM_FIVE_GER_OC","FORM_FIVE_ADJ_OC","FORM_FIVE_AP_OC","FORM_FIVE_PP_OC","FORM_FIVE_TO_OC","FORM_FIVE_RV_OC","FORM_FIVE_INTERR_OBJ","FORM_FIVE_PREP_OC","CLAUSE","CCLS","CCLS_FOR","CCLS_BESIDE","CCLS_YET","CCLS_NOR","NCLS","NCLS_SUBJ","NCLS_ACTUAL_SUBJ","NCLS_ACTUAL_OBJ","NCLS_OBJ","NCLS_COMP","ACLS","ACLS_WHO","ACLS_WHOSE","ACLS_WHOM","ACLS_WHICH","ACLS_THAT","ADVCLS","ADVCLS_IF","ADVCLS_UNLESS","ADVCLS_WHEN","ADVCLS_WHILE","ADVCLS_UNTIL","ADVCLS_BEFORE","ADVCLS_AFTER","ADVCLS_BECAUSE","ADVCLS_SINCE","ADVCLS_THOUGH","ADVCLS_ALTHOUGH","ADVCLS_EVEN_THOUGH","ADVCLS_SO_THAT","ADVCLS_SUCH_THAT","ADVCLS_AS","ADVCLS_AS_IF","ADVCLS_WHERE","PCLS","TO","TO_SUBJ","TO_OBJ","TO_ACTUAL_SUBJ","TO_ACTUAL_OBJ","TO_COMP","TO_ADJ","TO_ADV","GER","GER_SUBJ","GER_SUBJ_PP","GER_OBJ","GER_ACTUAL_OBJ","GER_COMP","PTC","AP","AP_OC","AP_COMP","PP","PP_OC","PP_COMP","SENSE_SUBJ","MODI","MODI_POST_AP","MODI_PRE_AP","MODI_POST_PP","INTERR","INTERR_SUBJ","INTERR_OBJ","INTERR_COMP","PREP_ADVBIAL","PREP_OBJ_ADVBIAL","PHR","PHR_ABOARD","PHR_ABOUT","PHR_ABOVE","PHR_ACCORDING","PHR_ACROSS","PHR_AFTER","PHR_AGAINST","PHR_AHEAD_OF","PHR_ALONG","PHR_ALONG_WITH","PHR_ALONGSIDE","PHR_AMID","PHR_AMIDST","PHR_AMONG","PHR_AMONGST","PHR_ANTI","PHR_APART_FROM","PHR_AROUND","PHR_AS","PHR_AS_FOR","PHR_AS_PER","PHR_AS_TO","PHR_AS_WELL_AS","PHR_AS_OF","PHR_ASIDE","PHR_ASTRIDE","PHR_AT","PHR_ATOP","PHR_AWAY_FROM","PHR_BAR","PHR_BARRING","PHR_BECAUSE_OF","PHR_BEFORE","PHR_BEHIND","PHR_BELOW","PHR_BENEATH","PHR_BESIDE","PHR_BESIDES","PHR_BETWEEN","PHR_BEYOND","PHR_BUT","PHR_BUT_FOR","PHR_BY","PHR_BY_MEANS_OF","PHR_CIRCA","PHR_CLOSE_TO","PHR_CONCERNING","PHR_CONSIDERING","PHR_CONTRARY_TO","PHR_COUNTING","PHR_CUM","PHR_DESPITE","PHR_DEPENDING_ON","PHR_DOWN","PHR_DUE_TO","PHR_DURING","PHR_EXCEPT","PHR_EXCEPT_FOR","PHR_EXCEPTING","PHR_EXCLUDING","PHR_FOLLOWING","PHR_FOR","PHR_FORWARD_OF","PHR_FROM","PHR_FURTHER_TO","PHR_GIVEN","PHR_GONE","PHR_IN","PHR_IN_ADDITION_TO","PHR_IN_BETWEEN","PHR_IN_CASE_OF","PHR_IN_FACE_OF","PHR_IN_FAVOUR_OF","PHR_IN_FRONT_OF","PHR_IN_LIEU_OF","PHR_IN_SPITE_OF","PHR_IN_VIEW_OF","PHR_INTO","PHR_INCLUDING","PHR_INSIDE","PHR_INSTEAD_OF","PHR_LESS","PHR_LIKE","PHR_MINUS","PHR_NEAR","PHR_NEAR_TO","PHR_NEXT_TO","PHR_NOTWITHSTANDING","PHR_OF","PHR_OFF","PHR_ON","PHR_ON_ACCOUNT_OF","PHR_ON_BEHALF_OF","PHR_ON_BOARD","PHR_ON_TO","PHR_ONTO","PHR_ON_TOP_OF","PHR_OPPOSITE","PHR_OPPOSITE_TO","PHR_OTHER_THAN","PHR_OUT","PHR_OUT_OF","PHR_OUTSIDE","PHR_OUTSIDE_OF","PHR_OVER","PHR_OWING_TO","PHR_PAST","PHR_PENDING","PHR_PER","PHR_PLUS","PHR_PREPARATORY_TO","PHR_PRIOR_TO","PHR_PRO","PHR_RE","PHR_REGARDING","PHR_REGARDLESS_OF","PHR_RESPECTING","PHR_ROUND","PHR_SAVE","PHR_SAVE_FOR","PHR_SAVING","PHR_SINCE","PHR_THROUGH","PHR_THRU","PHR_THROUGHOUT","PHR_TILL","PHR_TO","PHR_TOGETHER_WITH","PHR_TOUCHING","PHR_TOWARD","PHR_TOWARDS","PHR_THAN","PHR_THANKS_TO","PHR_UNDER","PHR_UNDERNEATH","PHR_UNLIKE","PHR_UNTIL","PHR_UP","PHR_UP_AGAINST","PHR_UP_TO","PHR_UP_UNTIL","PHR_UPON","PHR_VERSUS","PHR_VIA","PHR_WITH","PHR_WITH_REFERENCE_TO","PHR_WITH_REGARD_TO","PHR_WITHOUT","PHR_WITHIN","VERB_PHR"],t=["SUBJ","VERB","OBJ","COMP","OC","ADV"];p.meta={gramMetaStrFromDOM:r,saveGramMetaFromDOM:function(e,_,t,n){return _=r(_),R.ajax({url:`/${n}/sentence/grammeta/edit`,type:"POST",data:JSON.stringify({sentenceId:e,gramMeta:_,metaStatus:t?"S":"U"}),contentType:"application/json"}),_},submitMetaStatus:function(e,_,t,n){R.ajax({url:`/${t}/sentence/metastatus/edit`,type:"POST",data:JSON.stringify({sentenceId:e,metaStatus:_}),contentType:"application/json",success:n,error:()=>alert("분석 평가 중 에러가 발생했습니다.")})}}}(jQuery,document,tandem);