function getTextWidth(e,t){var n=(getTextWidth.canvas||(getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");return n.font=t,n.measureText(e).width}let invalidEnglishRegex=/[^\u0021-\u007E\s\u00C0-\u017E\u2010-\u2015\u2018-\u201A\u201C-\u201D\u2070-\u209C\u2160-\u217F°℃℉]/gi,invalidEnglishString="[^\\u0021-\\u007E\\s\\u00C0-\\u017E\\u2010-\\u2015\\u2018-\\u201A\\u201C-\\u201D\\u2070-\\u209C\\u2160-\\u217F°℃℉]";((e,t)=>{e.REGEX_VALID_SENTENCE_START=/^(["'(]|("'))?[A-Z0-9]/,e.REGEX_STR_VALID_SENTENCE_END="(\"?[.?!]('|'\")?|'?[.?!](\"|\"')?)$";let s=/\s*([‚،﹐﹑，､])/,l=/([“‟”„″‶❝❞〝〞＂]|'')/,h=/([´＇｀`‘’‛′‵❛❜])/,a=/([−–‒­])/,u=/([─―])/,c=/\s+([,.!?:;]+)/,p=/((?:\w[!?;]\w+|[A-z][:,]\w+|[0-9][:,][A-z]+)|(?:(?:\w[!?;]\w+|[A-z][:,]\w+|[0-9][:,][A-z]+)|(?:[A-z]\.(?:[A-Z][A-z]{1,}|\d+|I'[a-z]+))|\d\.[A-Z][A-z]*) )/,g=/(?:('\s+|\s+')((?:s|re|m|d|t|ll|ve)\s))/,o=new RegExp([s,l,h,a,u,c,p,g].map(e=>e.source).join("|")),n=(t.quoteNormalize=function(){return this.replace(new RegExp(l,"g"),'"').replace(new RegExp(h,"g"),"'").replace(new RegExp(s,"g"),",").replace(/[\u00A0\u2000-\u200B\u202F\u205F]/gi," ").replace(new RegExp(a,"g"),"-").replace(new RegExp(u,"g"),"—")},t.capitalize1st=function(){return this.charAt(0).toUpperCase()+this.slice(1)},t.parseToSentences=function(){return this.quoteNormalize().concatLines().insertSpace().shrinkSpaces().splitSentences()},t.concatLines=function(){return this.replace(/[\r\n]/g," ").trim()},t.insertSpace=function(){return this.replace(/(\b[a-z]\w*\W)([A-Z]\w*)/g,"$1 $2")},t.shrinkSpaces=function(){return this.replace(/\s+/g," ").replace(new RegExp(c,"g"),"$1")},t.sentenceNormalize=function(){return this.quoteNormalize().concatLines().shrinkSpaces().capitalize1st()},/(?<!\r)\n/gm);t.lf2crlf=function(){return this.replace(n,"\r\n")},e.wrapQuotes=function(e){var t=e.join(" "),n=Array.from(t.matchAll(/((?<![^\s"])(?<="?)'(?=[^'\s\t\b]+))|((?<![^\s'])(?<='?)"(?=[^"\s\t\b]+))/gm)).map(e=>({type:"open",text:e[0],index:e.index})),t=Array.from(t.matchAll(/(?<=[^"'\s\t\b]"?)'(?!\w)|(?<=[^"'\s\t\b]'?)"(?!\w)/gm)).map(e=>({type:"close",text:e[0],index:e.index}));let i=n.concat(t);for(i.sort((e,t)=>e.index-t.index);0<i.length&&"close"==i[0].type;)i.shift();if(i.length<2)return e;let r=[],s=("open"==i[0].type&&r.push(i.shift()),[]),l=0;return e.forEach(e=>{let t="";for(0<i.length&&"open"==i[0].type&&i[0].index<l+e.length&&r.push(i.shift());0<r.length&&0<i.length&&"close"==i[0].type&&r.slice(-1)[0].text==i[0].text&&l<=r.slice(-1)[0].index&&i[0].index<=l+e.length;)for(r.pop(),i.shift();0<i.length&&"open"==i[0].type;)r.push(i.shift());if(0==r.length||0==i.length||r.slice(-1)[0].index>l+e.length||i[0].index<l)s.push(e);else{for(r.slice(-1)[0].index<l&&0<i.length&&(t+=r.slice(-1)[0].text),t+=e,r.slice(-1)[0].index<l+e.length&&0<i.length&&l+e.length<i[0].index&&(t+=r.slice(-1)[0].text);0<i.length&&"close"==i[0].type&&i[0].index<l+e.length;)for(i[0].text==r.slice(-1)[0].text&&r.pop(),i.shift();0<i.length&&"open"==i[0].type;)r.push(i.shift());s.push(t)}l+=1+e.length}),s},e.extractHighlightInfo=function(e,t){let n=0,i=[],r;for(;null!=(r=o.exec(e));)for(n=1;n<9;n++)if(null!=r[n]){switch(n){case 1:t>=r.index&&(t-=r[0].length-1),i.push({highlight:[r.index,r.index+1]}),e=e.replace(s,",");break;case 2:i.push({highlight:[r.index,r.index+1]}),e=e.replace(l,'"');break;case 3:i.push({highlight:[r.index,r.index+1]}),e=e.replace(h,"'");break;case 4:i.push({highlight:[r.index,r.index+1]}),e=e.replace(a,"-");break;case 5:i.push({highlight:[r.index,r.index+1]}),e=e.replace(u,"—");break;case 6:t>=r.index&&(t-=r[0].length-1),i.push({highlight:[r.index,r.index+2]}),e=e.replace(c,r[n]);break;case 7:t>=r.index+1&&(t+=1),i.push({highlight:[r.index+2,r.index+3]}),e=e.replace(p,r[n].substring(0,2)+" "+r[n].substring(2));break;case 8:t>=r.index&&(t-=r[0].length-1-r[n].length),i.push({highlight:[r.index,r.index+r[n].length]}),e=e.replace(g,"'$2")}break}return{input:e=e.replaceAll(invalidEnglishRegex,"×"),inputCursor:t,arr:i}},e.sentenceSimilarity=function(e,t){function n(e){e=e.match(/\b\w+\b/g);let t={};return e.forEach(e=>{t[e]||(t[e]=0),t[e]++}),t}function i(e){let t=0;for(var n in e)e.hasOwnProperty(n)&&(t+=e[n]*e[n]);return Math.sqrt(t)}var e=n(e),t=n(t);return((e,t)=>{let n=0;for(var i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)&&(n+=e[i]*t[i]);return n})(e=e,t=t)/(i(e)*i(t))}})(this,String.prototype);