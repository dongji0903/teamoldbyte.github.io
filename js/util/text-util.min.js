function getTextWidth(e,t){const i=(getTextWidth.canvas||(getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");return i.font=t,i.measureText(e).width}const invalidEnglishRegex=/[^\u0021-\u007E\s\u2018-\u201A\u201C-\u201D]/gi,invalidEnglishString="[^!-~s‘-‚“-”]";!function(e,t){t.quoteNormalize=function(){return this.replace(/[“‟”„″‶❝❞〝〞＂]/gi,'"').replace(/[´＇｀`‘’‛′‵❛❜]/gi,"'").replace(/[‚،﹐﹑，､]/gi,",").replace(/\u00A0/gi," ")},t.capitalize1st=function(){return this.charAt(0).toUpperCase()+this.slice(1)},t.parseToSentences=function(){return this.quoteNormalize().concatLines().insertSpace().shrinkSpaces().splitSentences()},t.concatLines=function(){return this.replace(/[\r\n]/g," ").trim()},t.insertSpace=function(){return this.replace(/(\b[a-z]\w*\W)([A-Z]\w*)/g,"$1 $2")},t.shrinkSpaces=function(){return this.replace(/\s+/g," ").replace(/\s+([,.?!;:]+)/g,"$1")},t.sentenceNormalize=function(){return this.quoteNormalize().concatLines().shrinkSpaces().capitalize1st()},t.splitSentences=function(){try{return this.split(new RegExp('(?<!\\w\\.\\w.)(?<![A-Z][a-z]\\.)(?<! [A-Z]\\.)(?<=[\\.\\!\\?"])\\s',"gm"))}catch(e){if(console.warn('This browser does not support the RegExp "(?<=X)" and "(?<!X)", so it takes longer than other browsers...'),!this.match(/\s/))return[this];const s=[];let t=0,i=this.matchAll(/\s/gm);for(var h of i){var n=this.charAt(h.index-1);!/[\.\!\?]/.test(n)||/\w\.\w./.test(n)||/[A-Z][a-z]\./.test(n)||/ [A-Z]\./.test(n)||(s.push(this.substring(t,h.index)),t=h.index+1)}return t<=this.length+1&&s.push(this.substring(t)),s}},t.isSentence=function(){try{return/[A-Z\d'"]/.test(this.charAt())&&this.match(new RegExp("(?<!\\w\\.\\w.)(?<![A-Z][a-z]\\.)(?<=[\\.\\!\\?])","g"))?.index==this.length}catch(e){if(console.warn('This browser does not support the RegExp "(?<=X)" and "(?<!X)", so it takes longer than other browsers...'),/[A-Z\d'"]/.test(this.charAt())&&/[\.\?\!]['"]?$/.test(this)){var t;for(t of this.matchAll(/\S+[\.\?\!]['"]?/g))if(!/\w\.\w.$/.test(t[0])&&!/[A-Z][a-z]\.$/.test(t[0]))return t.index+t[0].length==this.length;return!1}return!1}},e.extractHighlightInfo=function(t,n){let e=0,s=[],i;for(;null!=(i=/\s*([‚،﹐﹑，､])|([“‟”„″‶❝❞〝〞＂])|([´＇｀`‘’‛′‵❛❜])|(\s{2,})|\s+([,.!?:;])|([,.!?:;]\w)|(?:'\s+((?:s|re|m|d|t|ll|ve)\s))/.exec(t));)for(e=1;e<8;e++)if(null!=i[e]){switch(e){case 1:n>=i.index&&(n-=i[0].length-1),s.push({highlight:[i.index,i.index+1]}),t=t.replace(i[0],",");break;case 2:s.push({highlight:[i.index,i.index+1]}),t=t.replace(i[0],'"');break;case 3:s.push({highlight:[i.index,i.index+1]}),t=t.replace(i[0],"'");break;case 4:n>=i.index&&(n-=i[0].length-1),s.push({highlight:[i.index,i.index+1]}),t=t.replace(i[0]," ");break;case 5:n>=i.index&&(n-=i[0].length-1),s.push({highlight:[i.index,i.index+2]}),t=t.replace(i[0],i[e]);break;case 6:n>=i.index&&(n-=i[0].length-1-i[e].length),s.push({highlight:[i.index,i.index+2]}),t=t.replace(i[0],i[e].substring(0,1)+" "+i[e].substring(1));break;case 7:n>=i.index&&(n-=i[0].length-1-i[e].length),s.push({highlight:[i.index,i.index+2]}),t=t.replace(i[0],"'"+i[e])}break}const r=s.length;for(const g of t.matchAll(/(["'])((?:\u0021|[\u0023-\u0026]|[\u0028-\u007E]|\s|(?:'(?:s|re|m|d|t|ll|ve)\s))+)\1(?!(?:(?:s|re|m|d|t|ll|ve) ))/g)){let e="",i=g[2],h=g.index+g[0].length;for(0==g.index||/\s/.test(t[g.index-1])||(s.forEach((e,t)=>{t>=r||(e.highlight[0]>=g.index&&e.highlight[0]--,e.highlight[1]>=g.index&&e.highlight[1]--)}),s.push({highlight:[g.index,g.index+1]}),n>=g.index&&n++,e+=" ",h++);i.startsWith(" ");)s.forEach((e,t)=>{t>=r||(e.highlight[0]>=g.index&&e.highlight[0]--,e.highlight[1]>=g.index&&e.highlight[1]--)}),n>=g.index&&n--,i=i.substring(1),h--;for(;i.endsWith(" ");)s.forEach((e,t)=>{t>=r||(e.highlight[0]>=g.index+i.length&&e.highlight[0]--,e.highlight[1]>=g.index+i.length&&e.highlight[1]--)}),n>g.index+i.length&&n--,i=i.slice(0,-1),h--;e+=g[1]+i+g[1],null!=t[g.index+g[0].length]&&0==/\s|[,.!?:;]/.test(t[g.index+g[0].length])&&(s.forEach((e,t)=>{t>=r||(e.highlight[0]>=h+1&&e.highlight[0]++,e.highlight[1]>=h+1&&e.highlight[1]++)}),s.push({highlight:[h,h+1]}),n>=h+1&&n++,e+=" "),t=t.replace(g[0],e)}return{input:t=t.replaceAll(invalidEnglishRegex,"×"),inputCursor:n,arr:s}}}(this,String.prototype);