!function(h,p,g){class a{constructor(e){"function"==typeof e&&(e={initSuccessCallback:e});var t=JSON.parse(localStorage.getItem("FicoTTSOptions"));x=Object.assign({},x,a.defaults,t,e),this.init()}}const s={"en-au-x-afh-network":"Narelle","en-au-x-afh-local":"Narelle","en-au-x-aua-network":"Abigail","en-au-x-aua-local":"Abigail","en-au-x-aub-network":"Braith","en-au-x-aub-local":"Braith","en-au-x-auc-network":"Kayla","en-au-x-auc-local":"Kayla","en-au-x-aud-network":"Lachlan","en-au-x-aud-local":"Lachlan","en-gb-x-fis-network":"Keira","en-gb-x-fis-local":"Keira","en-gb-x-gba-network":"Grace","en-gb-x-gba-local":"Grace","en-gb-x-gbb-network":"Taylor","en-gb-x-gbb-local":"Taylor","en-gb-x-gbc-network":"Lauren","en-gb-x-gbc-local":"Lauren","en-gb-x-gbd-network":"Nicholas","en-gb-x-gbd-local":"Nicholas","en-gb-x-gbg-network":"Libby","en-gb-x-gbg-local":"Libby","en-gb-x-rjs-network":"Peter","en-gb-x-rjs-local":"Peter","en-in-x-ahp-network":"Sayyar","en-in-x-ahp-local":"Sayyar","en-in-x-cxx-network":"Bahiya","en-in-x-cxx-local":"Bahiya","en-in-x-ena-network":"Farah","en-in-x-ena-local":"Farah","en-in-x-enc-network":"Atika","en-in-x-enc-local":"Atika","en-in-x-end-network":"Husam","en-in-x-end-local":"Husam","en-in-x-ene-network":"Salah","en-in-x-ene-local":"Salah","en-ng-x-tfn-network":"Jenete","en-ng-x-tfn-local":"Jenete","en-us-x-iob-network":"Josephine","en-us-x-iob-local":"Josephine","en-us-x-iog-network":"Gloria","en-us-x-iog-local":"Gloria","en-us-x-iol-network":"Joe","en-us-x-iol-local":"Joe","en-us-x-iom-network":"Paul","en-us-x-iom-local":"Paul","en-us-x-sfg-network":"Mary","en-us-x-sfg-local":"Mary","en-us-x-tpc-network":"Michelle","en-us-x-tpc-local":"Michelle","en-us-x-tpd-network":"James","en-us-x-tpd-local":"James","en-us-x-tpf-network":"Cathy","en-us-x-tpf-local":"Cathy",Alex:"Alex",Daniel:"Daniel",Fiona:"Fiona",Fred:"Fred",Karen:"Karen",Moira:"Moira",Rishi:"Rishi",Samantha:"Samantha",Tessa:"Tessa",Veena:"Veena",Victoria:"Victoria","Google US English":"Cathy","Google UK English Female":"Abbie","Google UK English Male":"Alexander","Microsoft Abeo Online (Natural) - English (Nigeria)":"Abeo","Microsoft Aria Online (Natural) - English (United States)":"Aria","Microsoft Clara Online (Natural) - English (Canada)":"Clara","Microsoft Emily Online (Natural) - English (Ireland)":"Emily","Microsoft Guy Online (Natural) - English (United States)":"Guy","Microsoft Jenny Online (Natural) - English (United States)":"Jenny","Microsoft Leah Online (Natural) - English (South Africa)":"Leah","Microsoft Natasha Online (Natural) - English (Australia)":"Natasha","Microsoft Neerja Online (Natural) - English (India)":"Neerja","Microsoft Rosa Online (Natural) - English (Philippines)":"Rosa","Microsoft Sonia Online (Natural) - English (United Kingdom)":"Sonia","Microsoft Zira Desktop - English (United States)":"Zira"},m="Welcome to fico. We are making all of the sentences in reading comprehension.";let u,b,f,x={initSuccessCallback:function(){},initFailCallback:function(){}};a.defaults={autoplay:!0,lang:"en",pitch:1,rate:.8,voiceIndex:0},function(){if("undefined"!=typeof ANI&&void 0!==ANI.ttsSpeak){const l=e=>{const t=Math.random().toString().substring(2);return p["TTSCallback"+t]=()=>{delete p["TTSCallback"+t],(e||(()=>{})).call(this)},`window.TTSCallback${t}();`};let e=l(()=>{console.info("initialize success"),u=JSON.parse(ANI.getVoices()).filter(e=>/^en[-_]/.test(e.lang)),b=Array.from(u).sort((e,t)=>e.name.localeCompare(t.name)),this.changeOptions(),p.addEventListener("pagehide",()=>this.stop()),"function"==typeof x.initSuccessCallback&&x.initSuccessCallback()});this.init=()=>{ANI.textToSpeechInit(x.lang,e,l(()=>{console.info("initialize failed"),"function"==typeof x.initFailCallback&&x.initFailCallback()})),n()},this.changeOptions=()=>{ANI.changeTTSOptions(JSON.stringify(Object.assign({},x,{voiceIndex:u.indexOf(b[x.voiceIndex])})))},this.speak=(e,...t)=>{0<t.length&&(t=[l(t[0])]),ANI.ttsSpeak(e,t)},this.speakRepeat=(e,t,a,...n)=>{0<n.length&&(n=[l(n[0])]),ANI.ttsSpeakRepeat(e,t,a,n)},this.speakSample=(e,t,a)=>{ANI.ttsSpeakSample(m,u.indexOf(b[e]),t,a,[l(()=>{ANI.changeTTSOptions(JSON.stringify(Object.assign({},x,{voiceIndex:u.indexOf(b[e])})))})])},this.stop=(...e)=>{0<e.length&&(e=[l(e[0])]),ANI.ttsStop(e)},this.autoEnabled=()=>x.autoplay;let t,a=0;this.openSettings=()=>{if(null==u||0==u.length)return null==t?(a=0,u=JSON.parse(ANI.getVoices()).filter(e=>/^en[-_]/.test(e.lang)),b=Array.from(u).sort((e,t)=>e.name.localeCompare(t.name)),t=setInterval(this.openSettings,250)):e in p&&a<20?a++:20<=a&&(a=0,clearInterval(t),t=null,alert("목소리 목록을 가져올 수 없습니다."),d()),!1;a=0,clearInterval(t),!localStorage.getItem("FicoTTSOptions")&&b.find(e=>"en-us-x-tpc-network"==e.name)&&(x.voiceIndex=b.findIndex(e=>"en-us-x-tpc-network"==e.name),this.changeOptions()),t=null,d()}}else{if(!("speechSynthesis"in p))return void alert('브라우저에서 지원하는 목소리가 없어서\n "읽어주는 서비스"가 제공되지 않습니다.');{let l=1,s=200,i,o,c;this.init=()=>{n(),(f=new SpeechSynthesisUtterance).onend=function(){1<l?(l--,i=setTimeout(()=>speechSynthesis.speak(f),s)):(clearInterval(c),c=null,clearTimeout(i),null!=o&&o(),o=null)},"onvoiceschanged"in speechSynthesis&&(speechSynthesis.onvoiceschanged=a),speechSynthesis.getVoices&&(a(),this.changeOptions())},this.speak=(e,t=()=>{})=>{null==this.initialized?setTimeout(()=>this.speak(e,t),250):(speechSynthesis.cancel(),clearTimeout(i),f.text=e,o=t,clearInterval(c),speechSynthesis.speak(f),r())},this.speakRepeat=(e,t,a,n=()=>{})=>{clearTimeout(i),speechSynthesis.speaking&&speechSynthesis.cancel(),f.text=e,l=t,s=a,o=n,clearInterval(c),speechSynthesis.speak(f),r()},this.speakSample=(e,t,a)=>{f.text=m,f.voice=b[e],f.rate=t,f.pitch=a,clearInterval(c),c=null,speechSynthesis.speaking&&speechSynthesis.cancel(),speechSynthesis.speak(f)},this.stop=(e=()=>{})=>{l=1,clearTimeout(i),clearInterval(c),c=null,speechSynthesis.cancel(),e()},this.autoEnabled=()=>x.autoplay,this.changeOptions=()=>{f.lang=x.lang,f.pitch=x.pitch,f.rate=x.rate,f.voice=b[x.voiceIndex]};let e,t=0;this.openSettings=()=>{if(null==u||0==u.length)return null==e?(t=0,u=speechSynthesis.getVoices().filter(e=>/^en-/.test(e.lang)&&"Google UK English Female"!=e.name),b=Array.from(u).sort((e,t)=>e.name.localeCompare(t.name)),e=setInterval(this.openSettings,250)):t<20?t++:(t=0,clearInterval(e),e=null,/Android/i.test(p.navigator.userAgent)&&!/FicoApp/i.test(p.navigator.userAgent)?(null==g.querySelector("#appPromotionModal")&&g.body.appendChild(createElement({el:"div",className:"modal fade",id:"appPromotionModal",tabIndex:"-1",role:"dialog",children:[{el:"div",className:"modal-dialog modal-dialog-centered",children:[{el:"div",className:"modal-content rounded-8",children:[{el:"div",className:"modal-header",children:[{el:"h5",class:"modal-title fw-bold text-fc-purple col-9",textContent:"앱을 설치해 보세요."},{el:"button",type:"button",class:"btn-close ms-2","data-bs-dismiss":"modal","aria-label":"Close",title:"닫기"}]},{el:"div",class:"modal-body",children:[{el:"div",className:"row g-0",children:[{el:"img",className:"col-auto rounded-8 my-auto",src:"https://static.findsvoc.com/images/logo/app_logo_square.png",width:"100",height:"100",onclick:function(){p.open("market://details?id=com.varxyz.demofico")}},{el:"div",className:"col-8 col-lg-9 ms-3 my-auto",children:["음성 설정이 지원되지 않습니다.",{el:"br"},{el:"span",style:'font-family: "Open Sans";',textContent:"Google Play"},"에서 ",{el:"span",className:"app-name-text",textContent:"fico"},"앱을 설치하면 ",{el:"br",className:"d-none d-md-block"},{el:"b",textContent:"다양한 음성 설정"},"이 가능합니다."]}]},{el:"a",href:"https://play.google.com/store/apps/details?id=com.varxyz.demofico&pcampaignid=pcampaignidMKT-Other-global-all-co-prtnr-py-PartBadge-Mar2515-1",children:[{el:"img",className:"w-100 mx-auto d-block",alt:"다운로드하기 Google Play",src:"https://play.google.com/intl/en_us/badges/static/images/badges/ko_badge_web_generic.png"}]}]}]}]}]})),h("#appPromotionModal").modal("show")):alert("목소리 목록을 가져올 수 없습니다.")),!1;t=0,clearInterval(e),e=null,d()};const a=()=>{u=speechSynthesis.getVoices().filter(e=>/^en-/.test(e.lang)&&"Google UK English Female"!=e.name),b=Array.from(u).sort((e,t)=>e.name.localeCompare(t.name)),f.voice=b[x.voiceIndex],this.initialized=!0,p.addEventListener("pagehide",()=>{this.stop()}),0<u.length&&null!=x.initSuccessCallback?x.initSuccessCallback.call(this):0==u.length&&null!=x.initFailCallback&&x.initFailCallback.call(this)};function r(){15<=60*(f.text.replace(/\W/g,"").length/5.1/150)/f.rate&&(c=setInterval(()=>{speechSynthesis.speaking&&!speechSynthesis.paused&&new Promise((e,t)=>{speechSynthesis.pause(),e()}).then(()=>speechSynthesis.resume())},14e3))}}}const n=()=>{null==g.querySelector("#ttsSettings")&&g.body.appendChild(createElement({el:"div",class:"modal fade",id:"ttsSettings",tabIndex:"-1","aria-modal":"true",role:"dialog",children:[{el:"div",class:"modal-dialog modal-dialog-centered",children:[{el:"div",class:"modal-content rounded-8",children:[{el:"style",textContent:"#ttsSettings input[type=range]::-webkit-slider-thumb {background:var(--fc-purple);}#ttsSettings .form-check-input:checked {background-color:var(--fc-purple);border-color:var(--fc-purple);}#ttsSettings .btn-check:checked+.btn {-webkit-animation: pulsate-bck 1s linear infinite both;animation: pulsate-bck 1s linear infinite both;}@-webkit-keyframes pulsate-bck {0% {-webkit-transform: scale(1);transform: scale(1);}50% {-webkit-transform: scale(0.9);transform: scale(0.9);}100% {-webkit-transform: scale(1);transform: scale(1);}}@keyframes pulsate-bck {0% {-webkit-transform: scale(1);transform: scale(1);}50% {-webkit-transform: scale(0.9);transform: scale(0.9);}100% {-webkit-transform: scale(1);transform: scale(1);}}#ttsSettings .form-check-input:focus {border-color:var(--fc-purple);box-shadow:0 0 0 0.25rem #58517440;background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%23847aaf'/%3e%3c/svg%3e\")}#ttsSettings input[type=range]::after {content:attr(data-range);margin-left:10px}"},{el:"div",class:"modal-header",children:[{el:"h5",class:"modal-title fw-bold text-fc-purple",textContent:"음성 환경설정"},{el:"div",class:"ms-auto text-align-end form-check form-switch",children:[{el:"input",type:"checkbox",id:"ttsToggle",class:"form-check-input",checked:x.autoplay},{el:"label",class:"form-check-label text-dark",htmlFor:"ttsToggle",textContent:"자동 재생"}]},{el:"button",type:"button",class:"btn-close ms-2","data-bs-dismiss":"modal","aria-label":"Close",title:"닫기"}]},{el:"div",class:"modal-body",children:[{el:"label",for:"ttsList",class:"form-label sub-title fs-6 text-dark",textContent:"목소리 선택"},{el:"div",class:"col-12 mb-3 row g-0",id:"ttsList"},{el:"label",for:"ttsRateRange",class:"form-label sub-title fs-6 text-dark",children:["목소리 빠르기 ",{el:"span",class:"text-secondary",textContent:"(기본: 0.8)"}]},{el:"input",type:"range",class:"form-range",id:"ttsRateRange",min:"0.1",max:"2",step:"0.1","data-range":x.rate.toFixed(1),value:x.rate.toFixed(1),oninput:function(){this.dataset.range=parseFloat(this.value).toFixed(1)}},{el:"label",for:"ttsPitchRange",class:"form-label sub-title fs-6 text-dark",children:["목소리 높이 ",{el:"span",class:"text-secondary",textContent:"(기본: 1.0)"}]},{el:"input",type:"range",class:"form-range",id:"ttsPitchRange",min:"0",max:"2",step:"0.1","data-range":x.pitch.toFixed(1),value:x.pitch.toFixed(1),oninput:function(){this.dataset.range=parseFloat(this.value).toFixed(1)}}]}]}]}]}))},d=()=>{var e=g.getElementById("ttsList");e.replaceChildren(createElement(Array.from(u,(e,t)=>({el:"div",class:"col-3 p-1 p-sm-3",children:[{el:"input",value:t,id:"ttsVoice"+t,name:"ttsVoice",type:"radio",class:"btn-check d-none","data-v-name":e.name},{el:"label",htmlFor:"ttsVoice"+t,class:"btn btn-outline-fico position-relative border-0 mx-auto p-1",children:[{el:"img",class:"rounded-circle w-100",src:`https://static.findsvoc.com/images/app/tts/profile/${s[e.name]||"default"}.jpg`},{el:"img",class:"rounded-3 position-absolute bottom-0 end-0 border",src:`https://flagcdn.com/w40/${e.lang.replace("scotland","GB-SCT").toLowerCase().substring(3)}.png`,style:"width:33%"}]},{el:"span",class:"d-block ps-2 text-fico",textContent:s[e.name]||e.name}]})).sort((e,t)=>e.children[0]["data-v-name"].localeCompare(t.children[0]["data-v-name"])))),h(e).find(`[name="ttsVoice"]:eq(${x.voiceIndex})`).prop("checked",!0),h("#ttsSettings").modal("show")};h(g).on("change","#ttsToggle",e=>{x.autoplay=e.target.checked}).on("click change","[name=ttsVoice], #ttsRateRange, #ttsPitchRange",()=>{this.speakSample(parseInt(h('#ttsSettings [name="ttsVoice"]:checked').index('[name="ttsVoice"]')),parseFloat(h("#ttsRateRange").val()),parseFloat(h("#ttsPitchRange").val()))}).on("hide.bs.modal","#ttsSettings",()=>{var e={voiceIndex:h('#ttsSettings [name="ttsVoice"]:checked').index('[name="ttsVoice"]'),pitch:parseFloat(h("#ttsPitchRange").val()),rate:parseFloat(h("#ttsRateRange").val())};x=Object.assign(x,e),this.changeOptions(),this.stop(),localStorage.setItem("FicoTTSOptions",JSON.stringify(Object.assign({},x)))})}.call(a.prototype),globalThis.FicoTTS=a}(jQuery,this,document);