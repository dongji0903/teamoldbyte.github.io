!function(e,r,t){class a{constructor(e){"function"==typeof e&&(e={initSuccessCallback:e});var t=JSON.parse(localStorage.getItem("FicoTTSOptions"));d=Object.assign({},d,a.defaults,t,e),this.init()}}const i={"en-au-x-aub-network":"Braith","en-au-x-aud-network":"Lachlan","en-au-x-afh-network":"Narelle","en-au-x-auc-network":"Kayla","en-au-x-aua-network":"Abigail","en-gb-x-gbb-network":"Taylor","en-gb-x-gbd-network":"Nicholas","en-gb-x-fis-network":"Keira","en-gb-x-gba-network":"Grace","en-gb-x-gbc-network":"Lauren","en-gb-x-rjs-network":"Peter","en-gb-x-gbg-network":"Libby","en-in-x-ene-network":"Salah","en-in-x-enc-network":"Atika","en-in-x-ena-network":"Farah","en-in-x-ahp-network":"Sayyar","en-in-x-cxx-network":"Bahiya","en-in-x-end-network":"Husam","en-ng-x-tfn-network":"Jenete","en-us-x-sfg-network":"Mary","en-us-x-tpd-network":"James","en-us-x-tpc-network":"Michelle","en-us-x-iob-network":"Josephine","en-us-x-iol-network":"Joe","en-us-x-iom-network":"Paul","en-us-x-iog-network":"Gloria","en-us-x-tpf-network":"Cathy",Alex:"Alex",Daniel:"Daniel",Fiona:"Fiona",Fred:"Fred",Karen:"Karen",Moira:"Moira",Rishi:"Rishi",Samantha:"Samantha",Tessa:"Tessa",Veena:"Veena",Victoria:"Victoria","Google US English":"Cathy","Google UK English Female":"Abbie","Google UK English Male":"Alexander","Microsoft Natasha Online (Natural) - English (Australia)":"Natasha","Microsoft Clara Online (Natural) - English (Canada)":"Clara","Microsoft Neerja Online (Natural) - English (India)":"Neerja","Microsoft Emily Online (Natural) - English (Ireland)":"Emily","Microsoft Abeo Online (Natural) - English (Nigeria)":"Abeo","Microsoft Rosa Online (Natural) - English (Philippines)":"Rosa","Microsoft Leah Online (Natural) - English (South Africa)":"Leah","Microsoft Sonia Online (Natural) - English (United Kingdom)":"Sonia","Microsoft Aria Online (Natural) - English (United States)":"Aria","Microsoft Guy Online (Natural) - English (United States)":"Guy","Microsoft Jenny Online (Natural) - English (United States)":"Jenny","Microsoft Zira Desktop - English (United States)":"Zira"},h="Hi. I'm fico advisor.";let p,g,d={initSuccessCallback:function(){},initFailCallback:function(){}};a.defaults={autoplay:!1,lang:"en",pitch:1,rate:.8,voiceIndex:0},function(){if("undefined"!=typeof ANI&&void 0!==ANI.ttsSpeak){const s=e=>{const t=Math.random().toString().substring(2);return r["TTSCallback"+t]=()=>{delete r["TTSCallback"+t],(e||(()=>{})).call(this)},`window.TTSCallback${t}();`};let e=s(()=>{console.info("initialize success"),p=JSON.parse(ANI.getVoices()).filter(e=>e.lang.startsWith("en-")),r.addEventListener("pagehide",()=>this.stop()),"function"==typeof d.initSuccessCallback&&d.initSuccessCallback()});this.init=()=>{ANI.textToSpeechInit(d.lang,e,s(()=>{console.info("initialize failed"),"function"==typeof d.initFailCallback&&d.initFailCallback()})),n()},this.changeOptions=e=>{d=Object.assign(d,e),localStorage.setItem("FicoTTSOptions",JSON.stringify(d)),ANI.changeTTSOptions(JSON.stringify(e))},this.speak=(e,...t)=>{0<t.length&&(t=[s(t[0])]),ANI.ttsSpeak(e,t)},this.speakRepeat=(e,t,a,...n)=>{0<n.length&&(n=[s(n[0])]),ANI.ttsSpeakRepeat(e,t,a,n)},this.speakSample=(e,t,a)=>{ANI.ttsSpeakSample(h,e,t,a,[s(()=>{ANI.changeTTSOptions(JSON.stringify(d))})])},this.stop=(...e)=>{0<e.length&&(e=[s(e[0])]),ANI.ttsStop(e)},this.autoEnabled=()=>d.autoplay;let t,a=0;this.openSettings=()=>{if(null==p||0==p.length)return null==t?(a=0,p=JSON.parse(ANI.getVoices()).filter(e=>e.lang.startsWith("en-")),t=setInterval(this.openSettings,250)):e in r&&a<20?a++:20<=a&&(a=0,clearInterval(t),t=null,alert("목소리 목록을 가져올 수 없습니다."),c()),!1;a=0,clearInterval(t),t=null,c()}}else{if(!("speechSynthesis"in r))return void alert('브라우저에서 지원하는 목소리가 없어서\n "읽어주는 서비스"가 제공되지 않습니다.');{let s=1,i=200,l,o;this.init=()=>{n(),(g=new SpeechSynthesisUtterance).onend=function(){1<s?(s--,l=setTimeout(()=>speechSynthesis.speak(g),i)):(clearTimeout(l),null!=o&&o(),o=null)},"onvoiceschanged"in speechSynthesis?speechSynthesis.onvoiceschanged=a:a()},this.speak=(e,t=()=>{})=>{null==this.initialized?setTimeout(()=>this.speak(e,t),250):(speechSynthesis.cancel(),clearTimeout(l),g.text=e,o=t,speechSynthesis.speak(g))},this.speakRepeat=(e,t,a,n=()=>{})=>{speechSynthesis.speaking&&speechSynthesis.cancel(),clearTimeout(l),g.text=e,s=t,i=a,o=n,speechSynthesis.speak(g)},this.speakSample=(e,t,a)=>{g.text=h,g.voice=p[e],g.rate=t,g.pitch=a,speechSynthesis.speaking&&speechSynthesis.cancel(),speechSynthesis.speak(g)},this.stop=(e=()=>{})=>{speechSynthesis.cancel(),clearTimeout(l),e()},this.autoEnabled=()=>d.autoplay,this.changeOptions=e=>{d=Object.assign(d,e),localStorage.setItem("FicoTTSOptions",JSON.stringify(d)),g.lang=d.lang,g.pitch=d.pitch,g.rate=d.rate,g.voice=p[d.voiceIndex]};let e,t=0;this.openSettings=()=>{if(null==p||0==p.length)return null==e?(t=0,p=speechSynthesis.getVoices().filter(e=>e.lang.startsWith("en-")),e=setInterval(this.openSettings,250)):t<20?t++:(t=0,clearInterval(e),e=null,alert("목소리 목록을 가져올 수 없습니다."),c()),!1;t=0,clearInterval(e),e=null,c()};const a=()=>{p=speechSynthesis.getVoices().filter(e=>e.lang.startsWith("en-")),g.voice=p[d.voiceIndex],this.initialized=!0,r.addEventListener("pagehide",()=>{this.stop()}),0<p.length&&null!=d.initSuccessCallback?d.initSuccessCallback.call(this):0==p.length&&null!=d.initFailCallback&&d.initFailCallback.call(this)}}}const n=()=>{null==t.querySelector("#ttsSettings")&&t.body.appendChild(createElement({el:"div",class:"modal fade",id:"ttsSettings",tabIndex:"-1","aria-modal":"true",role:"dialog",children:[{el:"div",class:"modal-dialog modal-dialog-centered",children:[{el:"div",class:"modal-content rounded-8",children:[{el:"style",textContent:"#ttsSettings input[type=range]::-webkit-slider-thumb {background:var(--fc-purple);}#ttsSettings .form-check-input:checked {background-color:var(--fc-purple);border-color:var(--fc-purple);}#ttsSettings .btn-check:checked+.btn {-webkit-animation: pulsate-bck 1s linear infinite both;animation: pulsate-bck 1s linear infinite both;}@-webkit-keyframes pulsate-bck {0% {-webkit-transform: scale(1);transform: scale(1);}50% {-webkit-transform: scale(0.9);transform: scale(0.9);}100% {-webkit-transform: scale(1);transform: scale(1);}}@keyframes pulsate-bck {0% {-webkit-transform: scale(1);transform: scale(1);}50% {-webkit-transform: scale(0.9);transform: scale(0.9);}100% {-webkit-transform: scale(1);transform: scale(1);}}#ttsSettings .form-check-input:focus {border-color:var(--fc-purple);box-shadow:0 0 0 0.25rem #58517440;background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%23847aaf'/%3e%3c/svg%3e\")}#ttsSettings input[type=range]::after {content:attr(data-range);margin-left:10px}"},{el:"div",class:"modal-header",children:[{el:"h5",class:"modal-title fw-bold text-fc-purple",textContent:"음성 환경설정"},{el:"div",class:"ms-auto text-align-end form-check form-switch",children:[{el:"input",type:"checkbox",id:"ttsToggle",class:"form-check-input",checked:d.autoplay},{el:"label",class:"form-check-label",htmlFor:"ttsToggle",textContent:"자동 재생"}]},{el:"button",type:"button",class:"btn-close ms-2","data-bs-dismiss":"modal","aria-label":"Close",title:"닫기"}]},{el:"div",class:"modal-body",children:[{el:"label",for:"ttsList",class:"form-label sub-title fs-6",textContent:"목소리 선택"},{el:"div",class:"col-12 mb-3 row g-0",id:"ttsList"},{el:"label",for:"ttsRateRange",class:"form-label sub-title fs-6",children:["목소리 빠르기 ",{el:"span",class:"text-secondary",textContent:"(기본: 0.8)"}]},{el:"input",type:"range",class:"form-range",id:"ttsRateRange",min:"0.1",max:"2",step:"0.1","data-range":d.rate.toFixed(1),value:d.rate.toFixed(1),oninput:function(){this.dataset.range=parseFloat(this.value).toFixed(1)}},{el:"label",for:"ttsPitchRange",class:"form-label sub-title fs-6",children:["목소리 높이 ",{el:"span",class:"text-secondary",textContent:"(기본: 1.0)"}]},{el:"input",type:"range",class:"form-range",id:"ttsPitchRange",min:"0",max:"2",step:"0.1","data-range":d.pitch.toFixed(1),value:d.pitch.toFixed(1),oninput:function(){this.dataset.range=parseFloat(this.value).toFixed(1)}}]}]}]}]}))},c=()=>{t.getElementById("ttsList").replaceChildren(createElement(Array.from(p,(e,t)=>({el:"div",class:"col-3 p-1 p-sm-3",children:[{el:"input",value:t,id:"ttsVoice"+t,name:"ttsVoice",type:"radio",class:"btn-check d-none",checked:t==d.voiceIndex},{el:"label",htmlFor:"ttsVoice"+t,class:"btn btn-outline-fico position-relative border-0 mx-auto p-1",children:[{el:"img",class:"rounded-circle w-100",src:`https://static.findsvoc.com/images/app/tts/profile/${i[e.name]||"default"}.jpg`},{el:"img",class:"rounded-3 position-absolute bottom-0 end-0 border",src:`https://flagcdn.com/w40/${e.lang.replace("scotland","GB-SCT").toLowerCase().substring(3)}.png`,style:"width:33%"}]},{el:"span",class:"d-block ps-2 text-fico",textContent:i[e.name]||e.name}]})))),e("#ttsSettings").modal("show")};e(t).on("change","#ttsToggle",e=>{d.autoplay=e.target.checked}).on("click change","[name=ttsVoice], #ttsRateRange, #ttsPitchRange",()=>{this.speakSample(parseInt(e('#ttsSettings [name="ttsVoice"]:checked').val()),parseFloat(e("#ttsRateRange").val()),parseFloat(e("#ttsPitchRange").val()))}).on("hide.bs.modal","#ttsSettings",()=>{this.changeOptions({voiceIndex:parseInt(e('#ttsSettings [name="ttsVoice"]:checked').val()),pitch:parseFloat(e("#ttsPitchRange").val()),rate:parseFloat(e("#ttsRateRange").val())}),this.stop()})}.call(a.prototype),globalThis.FicoTTS=a}(jQuery,this,document);