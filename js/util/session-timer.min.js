(()=>{const n=18e5,t="keypress.session click.session scroll.session";let a,s=n,o,i=!1,l=!1;function d(){var e;0<(s=a+n-(new Date).getTime())?6e5<s?(l=!1,i&&(i=!1,$(document).off(t))):i?s<=3e5&&($("#sessionTimeLeft").text(Math.floor(s/6e4)+"분 "+Math.floor(s%6e4/1e3)+"초"),document.hasFocus()||l?$("#sessionAlert").is(".show")||($(document).off(t),$("#sessionAlert").modal("show")):(clearInterval(o),e=document.title,document.title="💢💢세션 경고💢💢",l=!0,alert((new Date).toLocaleTimeString()+"\n경고 메세지를 확인해 주세요."),document.title=e,o=setInterval(d,1e3))):(i=!0,$(document).on(t,c)):r()}function c(){$.getJSON("/session/valid"),$(document).off(t)}function r(){clearInterval(o),$("#sessionAlert")?.modal("hide"),confirm("개인정보 보호를 위해\n로그인 후 30분동안 서비스 이용이 없어\n자동 로그아웃 되었습니다.\n\n다시 로그인을 하시려면 확인을 눌러주세요.")&&location.assign("/auth/login")}$.getJSON("/session/valid",e=>{e&&(a=(new Date).getTime(),$(document.body).append('<div class="modal fade" id="sessionAlert" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content fw-bold border-0"><div class="modal-header bg-fc-purple"><h5 class="modal-title text-white">이용 안내</h5></div><div class="modal-body text-center"><p>로그인 시간이 <span id="sessionTimeLeft" class="text-yellow-500"></span> 남았습니다.<br>로그인 시간을 연장하시겠습니까?</p><p>로그인 시간을 연장하시려면 아래 연장하기 버튼을 눌러주세요.</p></div><div class="modal-footer justify-content-center"><button type="button" class="btn btn-fico" id="extendSession" data-bs-dismiss="modal">연장하기</button><button type="button" class="btn btn-outline-fico" id="closeSessionAlert" data-bs-dismiss="modal">취소</button></div></div></div></div>').on("click","#extendSession",()=>{(a+n>(new Date).getTime()?c:r)()}).on("click","#closeSessionAlert",()=>{clearInterval(o),alert("로그아웃이 되면 작성 중인 내용은 저장되지 않습니다.")}),o=setInterval(()=>{(s=a+n-(new Date).getTime())<=0?r():s<=3e5&&(clearInterval(o),c(),o=setInterval(d,1e3))},1e3),$(document).ajaxComplete((e,t,s)=>{s=s.url;(s.startsWith("/")||s.startsWith("https://www.findsvoc.com")||s.startsWith("https://findsvoc.com"))&&"/session/valid"==s&&(a=(new Date).getTime()*(t.responseJSON?1:0)),t.responseJSON&&a+n>(new Date).getTime()?a=(new Date).getTime():r()}),$.ajaxPrefilter((e,t,s)=>{var o=e.url,i=(new Date).getTime();"POST"==e.type&&a+n<=i&&(o.startsWith("/")||o.startsWith("https://www.findsvoc.com")||o.startsWith("https://findsvoc.com"))&&(s.abort(),confirm("유효 시간이 만료되어 요청을 수행할 수 없습니다. 다시 로그인하시겠습니까?"))&&location.assign("/auth/login")}))}),Object.assign(window,{setMaxAlive:function(e){n=e},sessionExpiredConfirm:r,updateSession:c,checkSessionValid:d})})();