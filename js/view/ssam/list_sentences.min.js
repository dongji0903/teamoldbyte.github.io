function pageinit(w,d,r,e,n){const k={el:"div",className:"svoc-section row position-relative",children:[{el:"div",className:"svoc-block col my-auto"},{el:"div",className:"svoc-mdf-btns btn-group px-2",children:[{el:"button","data-seq":"",className:"js-edit-svoc login-required btn text-bluegray-300 p-0 pe-1","data-toggle":"tooltip",title:"분석 수정",children:[{el:"span",className:"fas fa-marker"}]},{el:"button","data-seq":"",className:"js-del-svoc login-required btn text-bluegray-300 p-0 ps-1","data-toggle":"tooltip",title:"분석 삭제",children:[{el:"span",className:"fas fa-trash-alt"}]}]},{el:"div",className:"writer-section col-12 col-md-1 mt-2 mt-xl-0 btn","data-bs-toggle":"collapse",children:[{el:"div",className:"personacon-alias alias text-truncate"}]}]},x={el:"div",className:"trans-mdf-btns",children:[{el:"button",type:"button",className:"js-edit-trans-open login-required btn btn-sm py-0 pe-0 pt-0","data-toggle":"tooltip",title:"해석 수정",children:[{el:"span",className:"material-icons fs-5",textContent:"edit"}]},{el:"button",type:"button",className:"js-del-trans login-required btn btn-sm py-0","data-toggle":"tooltip",title:"해석 삭제",children:[{el:"span",className:"material-icons fs-5",textContent:"delete"}]}]};const o={el:"div",className:"ailoading-icon position-relative overflow-hidden d-inline-block",style:{width:"50px",height:"50px"},children:[{el:"lottie-player",className:"position-absolute top-50 start-50 translate-middle",src:"https://assets1.lottiefiles.com/packages/lf20_iJX38w.json",background:"transparent",speed:"3",loop:!0,autoplay:!0,style:{width:"150px",height:"150px"}}]};document.querySelector("section").append(createElement([{el:"div",className:"check-modal-section modal fade",tabIndex:"-1",id:"check-modal",children:[{el:"div",className:"modal-dialog modal-dialog-centered",children:[{el:"div",className:"modal-content border-0",children:[{el:"div",className:"modal-header bg-fc-purple",children:[{el:"h5",className:"modal-title text-white col-10",textContent:"평가 감사합니다."},{el:"button",type:"button",className:"btn-close","data-bs-dismiss":"modal",ariaLabel:"Close"}]},{el:"div",className:"modal-body",children:[{el:"p"}]},{el:"div",className:"modal-footer justify-content-center",children:[{el:"button",type:"button",className:"btn btn-outline-fico","data-bs-dismiss":"modal",textContent:"취소"},{el:"button",type:"button",className:"tn btn-fico status-submit",textContent:"제출"}]}]}]}]}])),/Mobi/.test(navigator?.userAgent)&&screen.orientation||$(".js-rotate-btn").remove();var s=$(".result-section"),i=$(".one-sentence-unit-section").clone(),y=i.find(".ai-translation-block"),N=i.find(".one-word-unit-section"),I=i.find(".one-part-unit-section");for(let a=0,t=e.length;a<t;a++){var l=e[a];let t;0<a?(t=i.clone(),s.append(t)):t=$(".one-sentence-unit-section:eq(0)"),t.data("sentenceId",l.sid).attr("id","sentence"+(a+1));const f=new Date(l.regDate),u=(t.find(".s-regdate").text(f.format("yyyy-MM-dd HH:mm")),t.find(".origin-sentence-section").get(0));u.dataset.bsTarget="#sentence"+(a+1)+">.collapse",u.dataset.bsToggle="collapse",t.find('[role="tab"]').each(function(){var t=this.dataset.type;this.dataset.bsTarget="#sentence"+(a+1)+" ."+t+"-section";const e=new bootstrap.Tab(this),n=$(this),s=$(this.dataset.bsTarget);n.on("click",t=>{t.preventDefault(),n.is(".active")?s.collapse("hide"):e.show()}).one("shown.bs.tab",function(){s.find(".ailoading").prepend(createElement(o)),setTimeout(()=>{s.find("lottie-player")[0]?.stop(),s.find(".ailoading").remove(),s.find(".afterload").fadeIn(300)},1e3)}).on("shown.bs.tab",function(t){s.collapse("show")}).on("hidden.bs.tab",function(){s.removeClass("show")}),s.on("hidden.bs.collapse",function(t){t.target==s.get(0)&&(s.removeClass("active"),n.removeClass("active").attr("aria-selected",!1).blur())})}),t.find(".origin-sentence").append("<span class='numbering-text print-removed'>"+(n+a+1)+"</span><span class='sentence-text'>"+l.eng+"</span>")}$(document).on("show.bs.collapse hide.bs.collapse",".one-sentence-unit-section>.collapse",function(t){if(t.target==t.currentTarget){const e=$(this).closest(".one-sentence-unit-section");e.toggleClass("active","show"==t.type).find(".origin-sentence-section").attr("aria-expanded","show"==t.type),"show"==t.type&&(e[0].scrollIntoView(),e.is(".loaded,.loading")||(e.addClass("loading"),$.getJSON("/ssam/sentence/"+e.data("sentenceId"),t=>{!async function(i,l){const t=l.find(".origin-sentence .sentence-text").text(),e=i.svocList,c=e?.length;l.find(".js-collapse-svoc").toggle(1<c);for(let o=0;o<c;o++){let a=e[o];const m=$(createElement(k));0<o&&m.addClass("collapse"),m.appendTo(l.find(".result-semantic-section")),tandem.showSemanticAnalysis(t,a.svocBytes,m.find(".svoc-block")).then(t=>{$(t).data("svocId",a.svocId).data("memberId",a.memberId),m.find(".writer-section").attr("data-bs-target",`#${l.attr("id")} .dashboard-section`).find(".personacon-alias").text(a.writerAlias);let e=m.find(".svoc-mdf-btns");e.find("[data-seq]").attr("data-seq",t.dataset.seq),w!=a.memberId&&e.remove();const n=$("#hiddenDivs .member-personacon:eq(0)").clone(!0);if(a.image){const s=n.find(".personacon-profile").removeClass("profile-default")[0];s.style.background="url(/resource/profile/images/"+a.image+") center/cover no-repeat"}m.find(".writer-section").prepend(n),null!=window.tandem&&null!=tandem.meta&&o+1==c&&null!=i.metaStatus&&"N"==i.metaStatus&&tandem.meta.saveGramMetaFromDOM(i.sentenceId,t,!1,"workbook")})}l.find(".dashboard-section .meta-status").text({S:"🥳",F:"🤯"}[i.metaStatus]||"🤔").attr("title",{S:"평가를 받은 문장이예요.",F:"분석이 틀렸대요."}[i.metaStatus]||"아직 평가되지 않은 문장이예요.");var n=i.korList;if(null!=n&&0<n.length){const p=n.length,f=l.find(".ai-translation-section").show().empty();for(let t=0;t<p;t++){const u=y.clone();var s=n[t];f.append(u),u.data("korTid",s.korId),"Translator"!=s.alias&&u.find(".translator").text("by "+s.alias),u.find(".translation-text").text(s.kor),w==s.memberId&&u.append(createElement(x))}f.find(".ai-translation-block").first().collapse("show")}var a=i.wordList;if(null!=a&&0<a.length){const b=a.length,h=l.find(".word-section").empty();h.parent().prepend('<div class="title-section position-relative"><span class="sub-title">문장에서 등장하는 단어를 fico가 대신 검색하여 제공해 드립니다.</span></div>');for(let t=0;t<b;t++){const v=a[t],g=N.clone();g.find(".one-part-unit-section").remove(),h.append(g),g.find(".title").text(v.title);var o=v.senseList;if(null!=o){var d=o.length;for(let t=0;t<d;t++){var r=o[t];$partBlock=I.clone(),g.append($partBlock),$partBlock.find(".part").text(r.partType),$partBlock.find(".meaning").text(r.meaning)}}}}}(t,e),e.removeClass("loading").addClass("loaded")})))}}).on("shown.bs.collapse",".one-sentence-unit-section>.collapse",function(t){t.target.matches(".removable-section")&&t.target==t.currentTarget&&($(t.target).find(".semantics-result").filter(":visible").each(function(){tandem.correctMarkLine(this)}),$(t.target).find(".dashboard-section").show(0).trigger("show.bs.collapse"))});const a={S:"<b>평가를 하는 이유</b><br><br>A.I.는 인간의 언어를 이해하면서 분석하지 않습니다.<br>학습자들에게 도움이 될 수 있도록 분석 결과를 평가해주세요.<br>평가도 하고 다양한 fico Egg도 모아보세요.",F:"<b>AI 분석이 정확하지 않은가요?</b><br><br>그건 회원님이 AI보다 실력이 좋다는 증거입니다.<br>직접 수정할 수도 있고 그냥 내버려 둘 수도 있습니다.<br>실력 발휘 기대합니다."},m={S:{icon:"🥳",status:"S",tooltip:"평가를 받은 문장이예요."},F:{icon:"🤯",status:"F",tooltip:"분석이 틀렸대요."}};function p(e,n){let s=!1;e.closest(".dashboard-section").find(".edit-meta-status-btn[data-meta-status]").each(function(){if(!this.disabled){const t=$(this).prop("disabled",!0).wrap('<span data-bs-original-title="이미 평가한 문장입니다."></span>').parent()[0];new bootstrap.Tooltip(t,{trigger:"hover focus"}).enable(),t.querySelector(".material-icons").className="material-icons text-gray-400"}});const t=e.next();t.popover("show"),setTimeout(()=>t.popover("dispose"),3e3),anime({targets:e[0],rotateX:360,scale:[{value:3,duration:500,easing:"easeOutBack"},{value:1,duration:2500,easing:"easeInBounce"}],delay:300,duration:3e3,update:function(t){!s&&20<t.progress&&(e.text(n.icon).attr("data-bs-original-title",n.tooltip),s=!0)},complete:function(){e[0].style.transform=""}})}$("#check-modal").on("show.bs.modal",function(){const t=event.target.closest("button"),e=this.querySelector(".status-submit");var n=t.dataset.metaStatus;e.dataset.metaStatus=n,this.querySelector(".modal-body").innerHTML=a[n],$(e).data("sentenceSection",$(t.closest(".one-sentence-unit-section")))}),$("#check-modal .status-submit").on("click",function(){const t=$(this).data("sentenceSection"),e=this.dataset.metaStatus,n=t.find(".dashboard-section .meta-status");tandem?.meta?.submitMetaStatus(t.data("sentenceId"),e,"workbook",()=>{p(n,m[e])}),$("#check-modal").modal("hide")}),$(document).on("click",".open-kor-btn,.ai-translation-section",function(){const t=$(this).closest(".translation-section"),e=t.find(".ai-translation-block:not(:first)"),n=t.find(".open-kor-btn");e.collapse(n.is(".active")?"hide":"show"),n.find(".fold-icon").toggleClass("expanded",!n.is(".active")),n.toggleClass("active")}),$(".js-collapse-svoc").click(function(){$(this).closest(".one-sentence-unit-section").find(".result-semantic-section .collapse").collapse("toggle"),$(this).toggleClass("expanded")}),$(document).on("click",".js-add-svoc, .js-edit-svoc",async function(){let e=$(this).is(".js-add-svoc");$(".js-add-svoc").prop("disabled",!0);const n=$(this).closest(".one-sentence-unit-section");let a=null;if(e){var t=$(createElement(k)).addClass("new-svoc-form");t.find(".personacon-alias").text(d);const l=$("#hiddenDivs .member-personacon").clone(!0);if(r){const c=l.find(".personacon-profile").removeClass("profile-default")[0];c.style.background="url(/resource/profile/images/"+r+") center/cover no-repeat"}t.find(".writer-section").prepend(l);var s=n.find(".origin-sentence .sentence-text").text(),o=await tandem.getSvocBytes(n.find(".semantics-result").get(0));n.find(".result-semantic-section").prepend(t),(a=$(await tandem.showSemanticAnalysis(s,o,t.find(".svoc-block")))).data("memberId",w),t.find(".svoc-mdf-btns").hide().find("[data-seq]").attr("data-seq",a.attr("data-seq"))}else a=$('.semantics-result[data-seq="'+this.dataset.seq+'"]'),$(this).closest(".svoc-mdf-btns").hide();function i(t){e&&null!=t&&(a.closest(".new-svoc-form").removeClass("new-svoc-form"),a.data("svocId",t),n.find(".js-collapse-svoc").addClass("expanded").show(),a.closest(".svoc-section").nextAll(".svoc-section").collapse("show")),a.closest(".svoc-section").find(".svoc-mdf-btns").show()}a.svoceditor(e,function(t){const e=Number(a.closest(".one-sentence-unit-section").data("sentenceId")),n=Number(a.data("svocId")||0),s={sentenceId:e,memberId:w,encSvocText:t};w==Number(a.data("memberId"))&&0<n&&(s.svocId=n);editSvoc(s,i),window.tandem?.meta?.saveGramMetaFromDOM(e,a[0],!0,"workbook"),p(a.closest(".one-sentence-unit-section").find(".meta-status"),m.S)},function(){$(".js-add-svoc").prop("disabled",!1),e?a.closest(".new-svoc-form").remove():a.closest(".svoc-section").find(".svoc-mdf-btns").show()}),setTimeout(()=>{tandem.correctMarkLine(a[0])},500)}).on("click",".js-del-svoc",function(){const t=$('.semantics-result[data-seq="'+this.dataset.seq+'"]'),e=t.closest(".one-sentence-unit-section");var n=Number(t.data("svocId"));confirm("삭제하시겠습니까?")&&delSvoc(n,function(){t.closest(".svoc-section").fadeOut(()=>{t.closest(".svoc-section").remove(),e.find(".svoc-section").length<2&&e.find(".js-collapse-svoc").hide(),e.find(".svoc-section:first-child").removeClass("collapse show"),e.find(".svoc-section:not(:first-child)").addClass("collapse")})})});const c=$(createElement({el:"div",className:"trans-editor mt-2",children:[{el:"textarea",className:"text-input form-control"},{el:"div",className:"trans-edit-btns btn-group my-2",children:[{el:"button",type:"button",className:"js-edit-trans-cancel btn btn-sm btn-outline-fico",textContent:"취소"},{el:"button",type:"button",className:"js-edit-trans login-required btn btn-sm btn-fico",textContent:"확인"}]}]}));$(document).on("click",".js-edit-trans-open",function(){let t=$(this).closest(".ai-translation-block");0<t.length?(t.find(".trans-mdf-btns, .translation-text").hide(),c.find(".text-input").val(t.find(".translation-text").text())):(t=$(this).closest(".translation-section"),c.find(".text-input").val(null)),t.append(c)}).on("click",".js-edit-trans",function(){const n=$(this).closest(".ai-translation-block"),t=Number($(this).closest(".one-sentence-unit-section").data("sentenceId")),s=$(".trans-editor .text-input").val().trim(),a=$(this).closest(".translation-section");let e={sentenceId:t,memberId:w,kor:s};null!=n.data("korTid")&&(e.korTid=Number(n.data("korTid"))),0!=s.length&&editSentenceTrans(e,function(t){if(0<n.length)n.find(".translation-text").text(s),n.find(".trans-mdf-btns, .translation-text").show();else{const e=y.clone();e.data("korTid",t).find(".translation-text").text(s),e.find(".translator").text("by "+d),e.append(createElement(x)),a.find(".ai-translation-section").prepend(e),e.addClass("show"),a.find(".open-kor-btn").is(".active")||e.siblings(".ai-translation-block").removeClass("show")}$(".trans-editor").appendTo("#hiddenDivs")})}).on("click",".js-edit-trans-cancel",function(){const t=$(this).closest(".ai-translation-block");$(".trans-editor").appendTo("#hiddenDivs"),t.find(".trans-mdf-btns, .translation-text").show()}).on("click",".js-del-trans",function(){const t=$(this).closest(".ai-translation-block");confirm("삭제하겠습니까?")&&delSentenceTrans(Number(t.data("korTid")),function(){alert("삭제되었습니다."),t.next(".ai-translation-block")?.collapse("show"),t.remove()})})}const sleep=e=>new Promise(t=>setTimeout(t,e));