function pageinit(e,o,t,s){$(window).on("unload",()=>$("#loadingModal").modal("hide"));const m={itemSelector:".passage",columnWidth:".passage",gutter:10,percentPosition:!0,horizontalOrder:!0,transitionDuration:"0.8s"};function i(t,s){var i=[];for(let e=0,o=t.content?.length;e<o;e++){var a=t.content[e],n=$("#hiddenDivs .book-unit").clone(),r=(n.attr("href",location.origin+"/workbook/intro/"+ntoa(a.workBookId)),n.attr("data-work-book-id",a.workBookId).find(".book.cover"));0<a.imagePath?.length?(r.find(".default").hide(),r.find(".book-title").hide(),r.find(".book-cover-normal").addClass("swiper-lazy").attr("data-background","/resource/workbook/cover/"+a.imagePath)):(r.find(".swiper-lazy-preloader").remove(),"HELLO-BOOK"==a.title&&r.find(".book-title").hide(),r.find(".book-cover-normal").hide()),n.find(".workbook-type").text(a.workBookType),n.find(".workbook-type").addClass("type-"+a.workBookType),n.find(".book-title").text(a.title),n.find(".book-price").html(0<a.price?a.price.toLocaleString()+" gold eggs":"멤버십 무료"),i.push(n[0]),s.appendChild(n[0])}}e&&0<$(".public-workbook-section").length&&i(e,$(".public-workbook-section .list-inline").get(0)),o&&0<$(".protected-workbook-section").length&&i(o,$(".protected-workbook-section .list-inline").get(0)),t&&0<$(".classnote-workbook-section").length&&i(t,$(".classnote-workbook-section .list-inline").get(0)),$(".public-workbook-section,.protected-workbook-section,.classnote-workbook-section").each(function(){const o=$(this).find(".book").length;var e=matchMedia("(max-width: 575.8px)").matches?0:matchMedia("(max-width: 675.8px)").matches?1:matchMedia("(max-width: 991.8px)").matches?2:3,e=[9<o,8<o,10<o,14<o][e];new Swiper($(this).find(".swiper")[0],{watchSlidesProgress:!0,resistance:!1,freeMode:e,slidesPerView:"auto",grid:{fill:"row"},breakpoints:{320:{slidesPerGroup:3,autoHeight:o<=3,grid:{rows:6<o?3:3<o?2:1}},576:{slidesPerGroup:4,autoHeight:o<=4,grid:{rows:4<o?2:1}},676:{slidesPerGroup:5,autoHeight:o<=5,grid:{rows:5<o?2:1}},768:{slidesPerGroup:4,spaceBetween:30,autoHeight:o<=4,grid:{rows:4<o?2:1}},992:{slidesPerGroup:7,slidesPerView:7<o?7:"auto",spaceBetween:30,autoHeight:o<=7,grid:{rows:7<o?2:1}}},navigation:{prevEl:$(this).find(".swiper-button-prev")[0],nextEl:$(this).find(".swiper-button-next")[0]},lazy:!0,on:{beforeInit:function(e){e.isLast=o<24},afterInit:function(e){e.lazy.load()},click:function(e,o){if(e.clickedSlide){const k=$(e.el).closest(".workbook-section").siblings(".workbook-overview-section"),s=e.clickedSlide||o.path.find(e=>e.matches(".book-unit")),p=s.dataset.workBookId,b=ntoa(p),h=0<k.closest(".protected-workbook-section").length;function t({title:e,description:o,price:t,sub:s,copy:i,imagePath:a,alias:n,aliasImage:r,passageDtoList:l,regDate:c,ssamClassDto:d}){k.find(".writer-cover .alias").text(n),k.find(".writer-cover .personacon img").css("background-image",0<r?.length?`url(/resource/profile/images/${r})`:"var(--fc-logo-head)"),k.find(".title").text(e),h&&d&&k.find(".class-name").text(d.className||"이름없음"),k.find(".description").html(o),k.find(".price").text(0<t?t.toLocaleString()+" gold eggs":"무료"),k.find(".sub-btn").data("workBookId",p).toggleClass("bg-secondary",s).prop("disabled",s).text(s?"구독중":"구독"),k.find(".reg-date").text(new Date(c).toLocaleDateString()),k.find(".book-cover").toggleClass("default",null==a||0==a.length).find("img").attr("alt",e),k.find(".book-cover img").css("background-image",0<a?.length?`url(/resource/workbook/cover/${a})`:""),k.find(".book-title").text(e).toggle(null==a||0==a.length),k.find(".background-image").css("background-image","url(https://static.findsvoc.com/images/app/workbook/background/bg-"+(1+Math.floor(4*Math.random()))+".jpg)"),k.find(".catch-phrase-section .message").html(i.message),k.find(".catch-phrase-section .alias").text(i.alias),h&&d&&(d.emblemImagePath&&k.find(".emblem-image-section").css("background-image",`url(/resource/ssam/class/${d.emblemImagePath})`),d.classUri)&&k.find(".emblem-image-section").on("click",()=>{location.assign(location.origin+"/ssamclass/"+d.classUri)});n=k.find(".list-passage-section"),n.empty(),null!=n.data("masonry")&&n.masonry("destroy"),r=l;const g=r.map(e=>e.passageId);n.get(0).appendChild(createElement(Array.from(r,o=>({el:"a",className:"passage sample",href:`${location.origin}/workbook/passage/${b}/`+ntoa(o.passageId),textContent:Array.from(o.sentenceList,e=>e.eng).join(" "),onclick:function(e){e.preventDefault(),sessionStorage.setItem("workbookCover",a),sessionStorage.setItem("passageIdList",JSON.stringify(g)),$("#loadingModal").modal("show"),location.assign(`/workbook/passage/${b}/`+ntoa(o.passageId))}})))),k.is(".collapse.show")?(k[0].scrollIntoView(),n.masonry(m)):k.collapse("show")}$(".book-section .book-unit").not(s).removeClass("active"),$(s).toggleClass("active"),k.find(".description-section").addClass("shrink").css("max-height","13.5rem"),$(s).is(".active")?$(s).data("overview")?t($(s).data("overview")):$.getJSON("/workbook/overview/"+ntoa(s.dataset.workBookId),{classType:h},e=>{$(s).data("overview",e),t(e)}).fail(()=>alertModal("워크북정보 가져오기에 실패했습니다.\n다시 접속해 주세요.")):k.collapse("hide")}},reachEnd:function(o){if(!o.isLast&&!o.isLoading){o.isLoading=!0,o.pageNum||(o.pageNum=2);let e="public";0<$(o.el).closest(".protected-workbook-section").length?e="protected":0<$(o.el).closest(".classnote-workbook-section").length&&(e="class"),$.getJSON(`/workbook/${e}/list/`+o.pageNum++,function(e){i(e,o.wrapperEl),o.update(),o.slideNext(),delete o.isLoading,e.last&&(o.isLast=!0)}).fail(()=>alertModal("워크북목록 가져오기에 실패했습니다.\n다시 접속해 주세요."))}}}})}),$(".workbook-overview-section").on("shown.bs.collapse",function(){this.scrollIntoView(),$(this).find(".list-passage-section").masonry(m)}),$(document).on("click",".text-roll-end .fold-icon",function(){const e=$(this).closest(".description-section"),o=e.is(".shrink");var t=o?"100em":"13.5em";o&&e.removeClass("shrink"),anime({targets:e[0],duration:500,delay:0,maxHeight:t,easing:"linear",complete:()=>{$(this).toggleClass("expanded"),o||e.addClass("shrink")}})}),$("#js-play-tutorial").click(function(){$.ajax({dataType:"script",cache:!0,url:"https://static.findsvoc.com/js/app/tutorials.min.js"})}),$(".sub-btn").click(function(){if(0==s)confirmModal("fico 멤버십이 필요합니다.\n로그인 화면으로 이동하시겠습니까?",()=>location.assign("/auth/login"));else{const o=this;var e=$(this).data("workBookId");o.disabled=!0,$.post("/workbook/subscription/"+e,function(e){switch(e){case"success":$(o).addClass("bg-secondary").prop("disabled",!0).text("구독중"),confirmModal('나의 서재에 "구독 워크북"이 추가되었습니다.\n나의 서재로 이동하시겠습니까?',()=>location.assign("/workbook/mylibrary"));break;case"duplicated":$(o).addClass("bg-secondary").text("구독중").prop("disabled",!0),alertModal("이미 구독한 워크북입니다.");break;case"insufficient":$(o).removeClass("bg-secondary").text("구독").prop("disabled",!1),alertModal("잔여 gold egg가 부족합니다.");break;case"unauthorized":$(o).addClass("bg-secondary").text("구독").prop("disabled",!0),alertModal("골드 멤버십 워크북입니다.\n자신의 학습자료를 워크북으로 만들어 보세요.")}}).fail(e=>{403==e.status?location.assign("/membership/expired"):alertModal("워크북 구독에 실패했습니다. 화면 새로고침 후 다시 시도해 주세요.")})}}),$(".workbook-overview-section").on("shown.bs.collapse",function(){this.scrollIntoView({block:"center"}),$(this).find(".list-passage-section").masonry(m)}).on("hidden.bs.collapse",function(){$(this).find(".list-passage-section").find(".passage").remove()});let a;$(".tab-section").on("show.bs.tab click","[role=tab].active",function(e){a=e.currentTarget!=a?e.currentTarget:($(e.currentTarget).add(e.currentTarget.dataset.bsTarget).removeClass("active show"),null)})}