function pageinit(o,t){$("#loadingModal").modal("hide");var e=window.visualViewport.width<768;const b={itemSelector:".passage",columnWidth:".passage",gutter:10,percentPosition:!0,horizontalOrder:!0,transitionDuration:"0.8s"};e=e?3:2;function a(t){var a=[];for(let o=0,e=t.content?.length;o<e;o++){var i=t.content[o],s=$("#hiddenDivs .book-unit").clone(),n=(s.attr("href",location.origin+"/workbook/intro/"+ntoa(i.workBookId)),s.attr("data-work-book-id",i.workBookId).attr("data-writeralias",i.alias).attr("data-writerpic",i.image).find(".book.cover"));0<i.imagePath?.length?(n.find(".default").hide(),n.find(".book-title").hide(),n.find(".book-cover-normal").addClass("swiper-lazy").attr("data-background","/resource/workbook/cover/"+i.imagePath)):(n.find(".swiper-lazy-preloader").remove(),"HELLO-BOOK"==i.title&&n.find(".book-title").hide(),n.find(".book-cover-normal").hide()),s.find(".workbook-type").text(i.workBookType),s.find(".workbook-type").addClass("type-"+i.workBookType),s.find(".book-title").text(i.title),s.find(".book-price").html(0<i.price?i.price.toLocaleString()+" fico":"멤버십 무료"),a.push(s[0])}$(".book-section .list-inline").append(a)}a(o),new Swiper(".swiper",{slidesPerView:"auto",watchSlidesProgress:!0,simulateTouch:!0,resistance:!1,slidesPerGroupAuto:!0,grid:{rows:e},navigation:{prevEl:".swiper-button-prev",nextEl:".swiper-button-next"},lazy:!0,on:{click:function(o,e){if(o.clickedSlide){const l=$(".workbook-overview-section");o=o.clickedSlide||e.path.find(o=>o.matches(".book-unit"));const d=o.dataset.workBookId,g=ntoa(d),k=o.dataset.writeralias,p=o.dataset.writerpic;$(".book-section .book-unit").not(o).removeClass("active"),$(o).toggleClass("active"),$(o).is(".active")?$.getJSON("/workbook/overview/"+ntoa(o.dataset.workBookId),o=>{{var t=o,a=(l.find(".writer-cover .alias").text(k),l.find(".writer-cover .personacon img").css("background-image",0<p?.length?"url(/resource/profile/images/"+p+")":"var(--fc-logo-head)"),$("#subscribeWorkbook").data("workBookId",d),l.find(".title").text(t.title),l.find(".description").text(t.description),l.find(".price").text(0<t.price?t.price.toLocaleString()+" fico":"무료"),l.find("#subscribeWorkbook").toggleClass("bg-secondary",t.sub).prop("disabled",t.sub).text(t.sub?"구독중":"구독"),l.find(".reg-date").text(new Date(t.regDate).toLocaleDateString()),l.find(".book-cover").toggleClass("default",null==t.imagePath||0==t.iamgePath.length).find("img").attr("alt",t.title),l.find(".book-cover img").css("background-image",0<t.imagePath?.length?`url(/resource/workbook/cover/${t.imagePath})`:""),l.find(".book-title").text(t.title).toggle(null==t.imagePath||0==t.iamgePath.length),l.find(".background-image").css("background-image","url(https://static.findsvoc.com/images/app/workbook/background/bg-"+(1+Math.floor(4*Math.random()))+".jpg)"),l.find(".catch-phrase-section .message").html(t.copy.message),l.find(".catch-phrase-section .alias").text(t.copy.alias),l.find(".list-passage-section"));a.empty(),null!=a.data("masonry")&&a.masonry("destroy");const i=t.passageDtoList,s=i.map(o=>o.passageId);for(let o=0,e=i.length;o<e;o++){const n=i[o],r=n.sentenceList,c=$(`<a class="passage sample" href="${location.origin}/workbook/passage/${g}/${ntoa(n.passageId)}"></a>`)[0];c.onclick=o=>{o.preventDefault(),sessionStorage.setItem("workbookCover",t.imagePath),sessionStorage.setItem("passageIdList",JSON.stringify(s)),$("#loadingModal").modal("show"),location.assign(`/workbook/passage/${g}/`+ntoa(n.passageId))},c.innerText="";for(let o=0,e=r.length;o<e;o++)c.innerText+=r[o].eng;a.append(c)}l.is(".collapse.show")?(l[0].scrollIntoView(),a.masonry(b)):l.collapse("show")}}).fail(()=>alertModal("워크북정보 가져오기에 실패했습니다.\n다시 접속해 주세요.")):$(".workbook-overview-section").collapse("hide")}},reachEnd:function(e){e.isLast||e.isLoading||(e.isLoading=!0,$.getJSON("/workbook/recent/list/"+(e.pageNum++||2),function(o){a(o),e.update(),e.slideNext(),delete e.isLoading,o.last&&(e.isLast=!0)}).fail(()=>alertModal("워크북목록 가져오기에 실패했습니다.\n다시 접속해 주세요.")))}}}).pageNum=2,$(".workbook-overview-section").on("shown.bs.collapse",function(){this.scrollIntoView(),$(this).find(".list-passage-section").masonry(b)}),$("#js-play-tutorial").click(function(){$.ajax({dataType:"script",cache:!0,url:"https://static.findsvoc.com/js/app/tutorials.min.js"})}),$("#subscribeWorkbook").click(function(){if(0==t)confirm("fico 멤버십이 필요합니다.\n로그인 화면으로 이동하시겠습니까?")&&location.assign("/auth/login");else{const e=$(this);var o=$(this).data("workBookId");subscribeWorkbook(o,function(o){switch(o){case"success":e.addClass("bg-secondary").prop("disabled",!0).text("구독중"),confirm('나의 서재에 "구독 워크북"이 추가되었습니다.\n나의 서재로 이동하시겠습니까?')&&location.assign("/workbook/mylibrary");break;case"duplicated":alertModal("이미 구독한 워크북입니다.");break;case"insufficient":alertModal("잔여 fico 코인이 부족합니다.")}})}}),$(".workbook-overview-section").on("shown.bs.collapse",function(){this.scrollIntoView({block:"center"}),$(".workbook-overview-section .list-passage-section").masonry(b)}).on("hidden.bs.collapse",function(){$(this).find(".list-passage-section").find(".passage").remove()}),$(".tab-section").on("click show.bs.tab","[role=tab]",function(){event.cancelBubble=!0,event.eventPhase==Event.BUBBLING_PHASE&&($(this).add(this.dataset.bsTarget).removeClass("active"),$(this).attr("aria-selected",!1)),$(this).closest(".nav-tabs").toggleClass("active",event.eventPhase!=Event.BUBBLING_PHASE)})}