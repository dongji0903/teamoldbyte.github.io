function pageinit(o){function i(e,t){var o=t.numberOfElements;const i=[9<o,8<o,10<o,14<o][matchMedia("(max-width: 575.8px)").matches?0:matchMedia("(max-width: 675.8px)").matches?1:matchMedia("(max-width: 991.8px)").matches?2:3];new Swiper(e,{watchSlidesProgress:!0,slidesPerView:"auto",freeMode:i,grid:{fill:"row"},breakpoints:{320:{slidesPerGroup:3,autoHeight:o<=3,grid:{rows:6<o?3:3<o?2:1}},576:{slidesPerGroup:4,autoHeight:o<=4,grid:{rows:4<o?2:1}},676:{slidesPerGroup:5,autoHeight:o<=5,grid:{rows:5<o?2:1}},768:{slidesPerGroup:4,spaceBetween:28,autoHeight:o<=4,grid:{rows:4<o?2:1}},992:{slidesPerGroup:7,slidesPerView:7<o?7:"auto",spaceBetween:28,autoHeight:o<=7,grid:{rows:7<o?2:1}}},navigation:{prevEl:$(e).siblings(".swiper-button-section").find(".swiper-button-prev")[0],nextEl:$(e).siblings(".swiper-button-section").find(".swiper-button-next")[0]},lazy:{enabled:!0,loadPrevNext:!0},on:{beforeInit:function(e){e.isLast=t.last,t.last||(e.pageNum=2)},afterInit:function(e){i||e.lazy.load()},click:function(e){var t;e.clickedSlide&&(t=$(e.clickedSlide).closest(".workbook-block"),e=ntoa(e.clickedSlide.dataset.workBookId),location.assign(`/workbook/${t.is("#studyWorkbookSection")?"study/overview":"mybook/edit"}/`+e))},reachEnd:function(t){var e;t.isLast||t.isLoading||(e=t.el.dataset.listType,t.isLoading=!0,$.getJSON(`/workbook/library/${e}/list`,{pageNum:t.pageNum++},function(e){delete t.isLoading,e.first&&e.empty?(t.el.classList.add("h-auto"),t.wrapperEl.remove(),t.destroy()):($(t.el).find(".default-message").remove(),t.appendSlide(Array.from(e.content,e=>a(e))),t.update(),e.first&&t.lazy.load(),e.last&&(t.isLast=!0))}).fail(()=>alert("워크북목록 가져오기에 실패했습니다.\n다시 접속해 주세요.")))}}})}function s(o,e){var i=[];for(let e=0,t=o.content?.length;e<t;e++){var s=o.content[e];i.push(a(s))}e.append(i)}function a(e){var t=$("#hiddenDivs .book-unit").clone(),o=t.attr("data-work-book-id",e.workBookId).find(".book-cover");return t.find(".book-title").text(e.title),o.find("img").attr("alt",e.title),"HELLO-BOOK"==e.title?(o.addClass("hello-book").find(".swiper-lazy-preloader").remove(),t.find(".book-title").hide()):null==e.imagePath||0==e.imagePath.length?o.addClass("default").find(".swiper-lazy-preloader").remove():(o.find("img").addClass("swiper-lazy").attr("data-background","/resource/workbook/cover/"+e.imagePath),t.find(".book-title").hide()),t.find(".book-price").html(0<e.price?e.price.toLocaleString()+" fico":"멤버십 무료"),null!=e.numOfSubscribers&&t.append('<span class="subs-num">'+e.numOfSubscribers+"</span>"),t[0]}o.empty?$('.book-section[data-list-type="study"]').prepend(createElement({el:"span",className:"default-message",children:["다른 사람이 만든 워크북을 보고 싶다면?",{el:"br"},"워크북 구독을 하면 여기서 볼 수 있습니다."]})).find(".list-inline").css("height","auto"):s(o,$('.book-section[data-list-type="study"] .list-inline')),$(".swiper").each(function(){const t=this;var e=this.dataset.listType;"study"===e?i(t,o):$.getJSON(`/workbook/library/${e}/list`,{pageNum:1},function(e){e.empty?($(t).find(".list-inline").css("height","auto"),$(t).on("click",".book-unit",function(){var e=$(this).closest(".workbook-block"),t=ntoa(this.dataset.workBookId);location.assign(`/workbook/${e.is("#studyWorkbookSection")?"study/overview":"mybook/edit"}/`+t)}),$(t).siblings(".swiper-button-section").find(".swiper-button-prev,.swiper-button-next").remove()):($(t).find(".default-message").remove(),s(e,$(t).find(".swiper-wrapper")),i(t,e))}).fail(()=>alert("워크북목록 가져오기에 실패했습니다.\n다시 접속해 주세요."))}),$(document).on("show.bs.collapse hide.bs.collapse",".bookshelf-section",function(e){$(this).closest(".workbook-block").find(".title-section .fold-icon").toggleClass("expanded","show"==e.type)}),$(".bookshelf-section:not(.show)").collapse("show")}