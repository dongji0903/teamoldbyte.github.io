function pageinit(){function a(t,e){return Array.from(e,e=>s(t,e)).concat([{el:"label",className:"add-new-sense-label mb-3",textContent:"뜻 추가"},{el:"div",className:"add-new-sense-section",children:[{el:"div",className:"row g-3 mb-2",children:[{el:"div",className:"col-2",children:[{el:"select",className:"form-select",children:[{el:"option",value:"n.",textContent:"명사"},{el:"option",value:"ad.",textContent:"부사"},{el:"option",value:"v.",textContent:"동사"},{el:"option",value:"vt.",textContent:"타동사"},{el:"option",value:"vi.",textContent:"자동사"},{el:"option",value:"prep.",textContent:"전치사"},{el:"option",value:"conj.",textContent:"접속사"},{el:"option",value:"a.",textContent:"형용사"},{el:"option",value:"abbr.",textContent:"약어"},{el:"option",value:"pron.",textContent:"대명사"},{el:"option",value:"aux.",textContent:"조동사"},{el:"option",value:"num.",textContent:"수사"},{el:"option",value:"ordi.",textContent:"서수"},{el:"option",value:"int.",textContent:"감탄사"},{el:"option",value:"det.",textContent:"한정사"},{el:"option",value:"NP.",textContent:"명사구"},{el:"option",value:"PP.",textContent:"전치사구"},{el:"option",value:"ADP.",textContent:"부사구"},{el:"option",value:"AJP.",textContent:"형용사구"},{el:"option",value:"phrasal-v.",textContent:"구동사",selected:t},{el:"option",value:"VP.",textContent:"동사구"},{el:"option",value:"CP.",textContent:"연어"},{el:"option",value:"IP.",textContent:"관용어"}]}]},{el:"div",className:"col-8",children:[{el:"input",type:"text",className:"input-meaning form-text form-control mt-0",placeholder:`${t?65:100}자 이내의 뜻 입력`,maxLength:t?65:100,onclick:function(){$(this).closest(".add-new-sense-section").find(".js-add-meaning,.js-add-cancel").show()}}]},{el:"div",className:"col-2",children:[{el:"button",type:"button",className:"js-add-meaning btn btn-fico fas fa-check",style:"display:none;"},{el:"button",type:"button",className:"js-add-cancel btn btn-outline-fico fas fa-times",style:"display: none;"}]}]},t?[{el:"div",className:"row g-3 mb-1",children:[{el:"div",className:"col-2 text-end pe-2 lh-lg",children:[{el:"span",className:"badge rounded-pill bg-fc-purple",textContent:"A"}]},{el:"div",className:"col-8 text-center gx-3",children:[{el:"div",className:"input-example-eng eng form-control text-sm text-start",contentEditable:"plaintext-only",innerHTML:"","data-org":"",placeholder:"500자 이내의 예문 입력",oninput:function(){$(this).closest(".add-new-sense-section").find(".js-add-meaning,.js-add-cancel").show()}}]}]},{el:"div",className:"row g-3 mb-1",children:[{el:"div",className:"col-2 text-end pe-2 lh-lg",children:[{el:"span",className:"badge rounded-pill bg-danger",textContent:"가"}]},{el:"div",className:"col-8 text-center gx-3",children:[{el:"input",type:"text",className:"input-example-kor kor form-control text-sm",value:"","data-org":"",placeholder:"500자 이내의 해석 입력",oninput:function(){$(this).closest(".add-new-sense-section").find(".js-add-meaning,.js-add-cancel").show()}}]}]}]:""]}])}function s(e,t){return{el:"div",className:"one-part-unit-section g-3 mb-3","data-sid":t.sid||t.ssid||t.showUpId,children:[{el:"div",className:"row mb-1",children:[{el:"div",className:"col-2 text-end pe-5 lh-lg",children:[{el:"span",className:"part fs-5 lh-1",textContent:t.partType}]},{el:"div",className:"col-8 text-center",children:[{el:"input",type:"text",className:"input-meaning meaning form-control",value:t.meaning,"data-org":t.meaning,maxLength:e?65:100,placeholder:`${e?65:100}자 이내의 뜻 입력`,oninput:function(){$(this).closest(".one-part-unit-section").find(".js-edit-meaning,.js-edit-cancel").show()}}]},{el:"div",className:"col-2",children:[{el:"button",type:"button",className:"js-edit-meaning btn btn-fico fas fa-check w-25",style:"display:none;"},{el:"button",type:"button",className:"js-edit-cancel btn btn-outline-fico fas fa-times w-25",style:"display:none;"},{el:"button",type:"button",className:"js-del-meaning btn btn-outline-fico fas fa-trash w-25"}]}]},e?[{el:"div",className:"row mb-1",children:[{el:"div",className:"col-2 text-end pe-2 lh-lg",children:[{el:"span",className:"badge rounded-pill bg-fc-purple",textContent:"A"}]},{el:"div",className:"col-8 text-center",children:[{el:"div",className:"input-example-eng eng form-control text-sm text-start",contentEditable:"plaintext-only",innerHTML:t.eng||"","data-org":t.eng||"",placeholder:"500자 이내의 예문 입력",oninput:function(){$(this).closest(".one-part-unit-section").find(".js-edit-meaning,.js-edit-cancel").show()}},{el:"div",className:"ms-2 p-1 text-start fs-7 text-fc-red",textContent:"범위를 선택하고 우클릭하면 강조표시됩니다. (강조된 표시는 우클릭으로 다시 강조해제)"}]},{el:"div",className:"col-2"}]},{el:"div",className:"row",children:[{el:"div",className:"col-2 text-end pe-2 lh-lg",children:[{el:"span",className:"badge rounded-pill bg-danger",textContent:"가"}]},{el:"div",className:"col-8 text-center",children:[{el:"input",type:"text",className:"input-example-kor kor form-control text-sm",value:t.kor||"","data-org":t.kor||"",placeholder:"500자 이내의 해석 입력",oninput:function(){$(this).closest(".one-part-unit-section").find(".js-edit-meaning,.js-edit-cancel").show()}}]}]}]:""]}}$("#searchWordForm").on("submit",function(e){e.preventDefault();e=$("#searchOption").val();let l=$("#keywordDiv input").val().trim();0!=l.length&&($(".showup-sense-list-section").empty(),$.getJSON("/adminxyz/word/search/"+e,{value:l},function(e){var t=e.find(e=>e.title==l),n=t??e?.[0],t=($("#searchResult").collapse("show"),$("#searchResult").find(".saveTitle").text(l),$("#searchResult").find(".one-word-unit-section .word-title").text(n.title),$("#searchResult .empty-list").toggle(null==e||0==e.length||null==t),$("#searchResult .one-word-unit-section").toggle(null!=n),$("#searchResult .one-word-unit-section").children(":not(.title,.title-section)").remove(),n?($("#searchResult .lemma-section").show().find(".input-lemma").val(n.lemma||"")[0].dataset.org=n.lemma||"",$("#searchResult").get(0).dataset.wordId=n.wid,$("#searchResult .level").text(n.level),$("#searchResult .level-input").val(n.level),$("#searchResult .one-word-unit-section").get(0).appendChild(createElement(a(!1,n.senseList)))):$("#searchResult .lemma-section").hide(),e.filter(e=>0<e.showUpSenseList?.length));0<t.length?$(".showup-sense-list-section").get(0).appendChild(createElement(Array.from(t,(e,t)=>({el:"div",className:"showup-word"+(0<t?" mt-4 pt-2 border-top border-2":""),"data-word-id":e.wid,children:[{el:"div",className:"title-section row mt-1 g-3",children:[{el:"div",className:"my-auto",children:[{el:"h5",className:"word-title title fs-5 d-inline me-2",textContent:e.title}]}]}].concat(a(!0,e.showUpSenseList))})))):$(".showup-sense-list-section").html("검색 결과가 없습니다.")}).fail((e,t)=>{"parsererror"==t?($("#searchResult .lemma-section").hide(),$("#searchResult").collapse("show"),$("#searchResult .saveTitle").text(l),$("#searchTitle, #saveTitle").val(l),$("#searchResult .empty-list").show(),$("#searchResult .one-word-unit-section").hide()):alertModal("에러가 발생했습니다.\n"+e.responseJSON.exception)}))}),$(".input-lemma").on("input",function(){$(this).closest(".lemma-section").find(".edit-button-section").show()}),$(".js-edit-lemma").on("click",function(){var e=parseInt($("#searchResult").get(0).dataset.wordId);let t=$(".input-lemma").val().trim();$.ajax({url:"/adminxyz/dictionary/lemma/edit",type:"POST",data:{wordId:e,lemma:t},success:()=>{alertModal("lemma 정보가 수정되었습니다."),setTimeout(()=>$("#alertModal").modal("hide"),800),$(".input-lemma").attr("data-org",t),$(".lemma-section .edit-button-section").hide()}})}),$(".js-edit-lemma-cancel").on("click",function(){var e=$(".input-lemma");e.val(e[0].dataset.org),$(this).closest(".edit-button-section")}),$(".level, .level-edit-open-btn").on("click",function(){$("#searchResult").find(".level, .level-edit-open-btn, .level-input, .js-level-edit, .js-level-cancel").toggle(),$("#searchResult .level-input").val($("#searchResult .level").text()).focus()}),$(".js-level-edit").on("click",function(){let e=$("#searchResult .level");var t=$("#searchResult .level-input");let n=parseInt(t.val().trim());Number.isNaN(n)||1e4<n||n<0?(alertModal("0~10,000 숫자를 입력해 주세요."),t.focus()):(t=parseInt($("#searchResult").get(0).dataset.wordId),$.ajax({type:"POST",url:"/adminxyz/dictionary/level/edit",data:{wordId:t,level:n},success:function(){alertModal("단어 난이도가 수정되었습니다."),e.text(n),$("#searchResult").find(".level, .level-edit-open-btn, .level-input, .js-level-edit, .js-level-cancel").toggle()},error:function(){alertModal("에러가 발생했습니다.\n"+xhr.responseJSON.exception)}}))}),$(".js-level-cancel").on("click",function(){$("#searchResult").find(".level, .level-edit-open-btn, .level-input, .js-level-edit, .js-level-cancel").toggle()}),$("#register").on("click",function(){let n=$("#searchTitle").val().trim();var e=$("#saveTitle").val().trim();$.getJSON("/adminxyz/unword/add",{searchTitle:n,saveTitle:e},function(){alertModal(`단어 ${n}(이)가 등록되었습니다.`),$("#alertModal").on("hide.bs.modal",()=>location.reload())}).fail((e,t)=>{"parsererror"==t?(alertModal(`단어 ${n}(이)가 등록되었습니다.`),$("#alertModal").on("hide.bs.modal",()=>location.reload())):alertModal("에러가 발생했습니다.\n"+e.responseJSON.exception)})}),$(document).on("contextmenu",".input-example-eng",function(t){var n,l=getSelection(),a=t.target.closest(".eng"),s=l.getRangeAt(0);if(!l.isCollapsed||l.focusNode.parentElement.closest("strong")){l.isCollapsed?l.focusNode.parentElement.closest("strong")&&(n=l.focusNode.parentElement.closest("strong"),t.preventDefault(),n.replaceWith(n.textContent),l.removeAllRanges()):(t.preventDefault(),n=createElement({el:"strong",textContent:s.toString()}),s.deleteContents(),s.insertNode(n)),a.childNodes.forEach(e=>{0==e.textContent.length&&e.remove()});let e=a.firstChild;for(;e;)e.previousSibling?.nodeName==e.nodeName&&(e.textContent=e.previousSibling.textContent.concat(e.textContent),e.previousSibling.remove()),e=e.nextSibling;this.closest(".one-part-unit-section").querySelector(".input-meaning").dispatchEvent(new InputEvent("input"))}}).on("click",".js-edit-meaning",function(){var e=$(this).closest(".one-part-unit-section"),t=parseInt(e.get(0).dataset.sid);let n=e.find(".input-meaning"),l=e.find(".input-example-eng"),a=e.find(".input-example-kor"),s={meaning:n.val().trim()},o=0<e.closest(".showup-sense-list-section").length;o?(s.wordId=parseInt(e.closest(".showup-word").get(0).dataset.wordId),s.showUpId=t,s.partType=e.find(".part").text(),s.eng=l.html().trim(),s.kor=a.val().trim()):s.senseId=t,$.ajax({url:`/adminxyz/dictionary/${o?"showup":""}sense/edit`,type:"POST",data:s,success:()=>{alertModal(`뜻이 수정되었습니다.
: `+s.meaning+(o?"\n예문:\n"+s.eng+"\n"+s.kor:"")),n.get(0).dataset.org=s.meaning,o&&(l.get(0).dataset.org=s.eng,a.get(0).dataset.org=s.kor)},error:()=>alertModal("수정이 실패했습니다.")})}).on("click",".js-edit-cancel",function(){$(this).closest(".one-part-unit-section").find("input,[contenteditable]").each(function(){this.matches("input")?$(this).val($(this).get(0).dataset.org):$(this).html($(this).get(0).dataset.org)}),$(this).hide(),$(this).siblings(".js-edit-meaning").hide()}).on("click",".js-add-meaning",function(){var e=$(this).closest(".add-new-sense-section"),n=e.find("select"),l=e.find("input");if(0!=l.val().trim()){let t=0<$(this).closest(".showup-word").length;n={wordId:parseInt($(this).closest(".showup-word,#searchResult").get(0).dataset.wordId),partType:n.val(),meaning:l.val().trim()};t&&(n.eng=e.find(".input-example-eng").html().trim(),n.kor=e.find(".input-example-kor").val().trim()),$.ajax({url:`/adminxyz/dictionary/${t?"showup":""}sense/add`,type:"POST",data:n,success:e=>{alertModal(`뜻이 추가되었습니다.
: ${e.partType} `+e.meaning),$(".add-new-sense-label").before(createElement(s(t,e)))},error:()=>alertModal("단어 뜻을 추가하지 못 했습니다.")})}}).on("click",".js-add-cancel",function(){$(this).hide(),$(this).closest(".add-new-sense-section").find(".js-add-meaning").hide(),$(this).closest(".add-new-sense-section").find("input").val("")}).on("click",".js-del-meaning",function(){let e=$(this).closest(".one-part-unit-section");var t={};this.closest(".showup-word")?(t.wordId=parseInt(e.closest(".showup-word").get(0).dataset.wordId),t.showUpId=parseInt(e.get(0).dataset.sid)):t.senseId=parseInt(e.get(0).dataset.sid),$.ajax({url:`/adminxyz/dictionary/${this.closest(".showup-word")?"showup":""}sense/del`,type:"POST",data:t,success:()=>{alertModal("뜻을 삭제했습니다."),e.remove()},error:()=>alertModal("단어 뜻을 삭제하지 못 했습니다.")})})}