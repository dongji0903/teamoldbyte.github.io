function pageinit(){function l(t,e){return Array.from(e,e=>a(t,e)).concat([{el:"label",className:"add-new-sense-label mb-3",textContent:"뜻 추가"},{el:"div",className:"add-new-sense-section row g-3",children:[{el:"div",className:"col-2",children:[{el:"select",className:"form-select",children:[{el:"option",value:"n.",textContent:"명사"},{el:"option",value:"ad.",textContent:"부사"},{el:"option",value:"v.",textContent:"동사"},{el:"option",value:"vt.",textContent:"타동사"},{el:"option",value:"vi.",textContent:"자동사"},{el:"option",value:"prep.",textContent:"전치사"},{el:"option",value:"conj.",textContent:"접속사"},{el:"option",value:"a.",textContent:"형용사"},{el:"option",value:"abbr.",textContent:"약어"},{el:"option",value:"pron.",textContent:"대명사"},{el:"option",value:"aux.",textContent:"조동사"},{el:"option",value:"num.",textContent:"수사"},{el:"option",value:"ordi.",textContent:"서수"},{el:"option",value:"int.",textContent:"감탄사"},{el:"option",value:"det.",textContent:"한정사"},{el:"option",value:"phrasal-v.",textContent:"구동사",selected:t}]}]},{el:"div",className:"col-8",children:[{el:"input",type:"text",className:"input-meaning form-text form-control mt-0",placeholder:`${t?65:100}자 이내의 뜻 입력`,maxLength:t?65:100,onclick:function(){$(this).closest(".add-new-sense-section").find(".js-add-meaning,.js-add-cancel").show()}}]},{el:"div",className:"col-2",children:[{el:"button",type:"button",className:"js-add-meaning btn btn-fico fas fa-check",style:"display:none;"},{el:"button",type:"button",className:"js-add-cancel btn btn-outline-fico fas fa-times",style:"display: none;"}]},t?{el:"div",className:"col-12 row gx-0",children:[{el:"div",className:"col-2 text-end pe-2 lh-lg",children:[{el:"span",className:"badge rounded-pill bg-fc-purple",textContent:"A"}]},{el:"div",className:"col-8 text-center gx-3",children:[{el:"div",className:"input-example-eng eng form-control text-sm text-start",contentEditable:"plaintext-only",innerHTML:"","data-org":"",placeholder:"500자 이내의 예문 입력",oninput:function(){$(this).closest(".add-new-sense-section").find(".js-add-meaning,.js-add-cancel").show()}}]},{el:"div",className:"col-2"},{el:"div",className:"col-2 text-end pe-2 lh-lg",children:[{el:"span",className:"badge rounded-pill bg-danger",textContent:"가"}]},{el:"div",className:"col-8 text-center gx-3",children:[{el:"input",type:"text",className:"input-example-kor kor form-control text-sm",value:"","data-org":"",placeholder:"500자 이내의 해석 입력",oninput:function(){$(this).closest(".add-new-sense-section").find(".js-add-meaning,.js-add-cancel").show()}}]}]}:""]}])}function a(e,t){return{el:"div",className:"one-part-unit-section row g-3 mb-3","data-sid":t.sid||t.ssid||t.showUpId,children:[{el:"div",className:"col-2 text-end pe-5 lh-lg",children:[{el:"span",className:"part fs-5 lh-1",textContent:t.partType}]},{el:"div",className:"col-8 text-center",children:[{el:"input",type:"text",className:"input-meaning meaning form-control",value:t.meaning,"data-org":t.meaning,maxLength:e?65:100,placeholder:`${e?65:100}자 이내의 뜻 입력`,oninput:function(){$(this).closest(".one-part-unit-section").find(".js-edit-meaning,.js-edit-cancel").show()}}]},{el:"div",className:"col-2",children:[{el:"button",type:"button",className:"js-edit-meaning btn btn-fico fas fa-check",style:"display:none;"},{el:"button",type:"button",className:"js-edit-cancel btn btn-outline-fico fas fa-times",style:"display:none;"},e?{el:"button",type:"button",className:"js-del-meaning btn btn-outline-fico fas fa-trash "}:""]},e?{el:"div",className:"col-12 row gx-0",children:[{el:"div",className:"col-2 text-end pe-2 lh-lg",children:[{el:"span",className:"badge rounded-pill bg-fc-purple",textContent:"A"}]},{el:"div",className:"col-8 text-center gx-3",children:[{el:"div",className:"input-example-eng eng form-control text-sm text-start",contentEditable:"plaintext-only",innerHTML:t.eng||"","data-org":t.eng||"",placeholder:"500자 이내의 예문 입력",oninput:function(){$(this).closest(".one-part-unit-section").find(".js-edit-meaning,.js-edit-cancel").show()}}]},{el:"div",className:"col-2"},{el:"div",className:"col-2 text-end pe-2 lh-lg",children:[{el:"span",className:"badge rounded-pill bg-danger",textContent:"가"}]},{el:"div",className:"col-8 text-center gx-3",children:[{el:"input",type:"text",className:"input-example-kor kor form-control text-sm",value:t.kor||"","data-org":t.kor||"",placeholder:"500자 이내의 해석 입력",oninput:function(){$(this).closest(".one-part-unit-section").find(".js-edit-meaning,.js-edit-cancel").show()}}]}]}:""]}}$("#searchWordForm").on("submit",function(e){e.preventDefault();e=$("#searchOption").val();const n=$("#keywordDiv input").val().trim();0!=n.length&&$.getJSON(`/adminxyz/word/search/${e}/`+n,function(e){var t=e.find(e=>e.title==n&&!(0<e.showUpSenseList?.length)),t=($("#searchResult").collapse("show"),$("#searchResult").find(".saveTitle,.one-word-unit-section .word-title").text(n),$("#searchResult .empty-list").toggle(null==e||0==e.length),$("#searchResult .one-word-unit-section").toggle(null!=t),$("#searchResult .one-word-unit-section").children(":not(.title,.title-section)").remove(),t&&($("#searchResult").attr("data-word-id",t.wid),$("#searchResult .level").text(t.level),$("#searchResult .level-input").val(t.level),$("#searchResult .one-word-unit-section").get(0).appendChild(createElement(l(!1,t.senseList)))),e.filter(e=>0<e.showUpSenseList?.length));$(".showup-sense-list-section").children(":not(.title)").remove(),$(".showup-sense-list-section").get(0).appendChild(createElement(Array.from(t,(e,t)=>({el:"div",className:"showup-word"+(0<t?" mt-3 border-top":""),"data-word-id":e.wid,children:[{el:"div",className:"title-section row mt-1 g-3",children:[{el:"div",className:"my-auto",children:[{el:"label",textContent:"타이틀"},{el:"h5",className:"word-title title fs-5 d-inline me-2",textContent:e.title}]}]}].concat(l(!0,e.showUpSenseList))}))))}).fail((e,t)=>{"parsererror"==t?($("#searchResult").collapse("show"),$("#searchResult .title").text(n),$("#searchTitle, #saveTitle").val(n),$("#searchResult .empty-list").show(),$("#searchResult .one-word-unit-section").hide()):alertModal("에러가 발생했습니다.\n"+e.responseJSON.exception)})}),$(".level").on("click",function(){$("#searchResult").find(".level, .level-input, .js-level-edit, .js-level-cancel").toggle(),$("#searchResult .level-input").val($(this).text()).focus()}),$(".js-level-edit").on("click",function(){const e=$("#searchResult .level");var t=$("#searchResult .level-input");const n=parseInt(t.val().trim());Number.isNaN(n)||1e4<n||n<0?(alertModal("0~10,000 숫자를 입력해 주세요."),t.focus()):(t=parseInt($("#searchResult").attr("data-word-id")),$.ajax({type:"POST",url:"/adminxyz/dictionary/level/edit",data:{wordId:t,level:n},success:function(){alertModal("단어 난이도가 수정되었습니다."),e.text(n),$("#searchResult").find(".level, .level-input, .js-level-edit, .js-level-cancel").toggle()},error:function(){alertModal("에러가 발생했습니다.\n"+xhr.responseJSON.exception)}}))}),$(".js-level-cancel").on("click",function(){$("#searchResult").find(".level, .level-input, .js-level-edit, .js-level-cancel").toggle()}),$("#register").on("click",function(){var e=$("#searchTitle").val().trim(),t=$("#saveTitle").val().trim();$.getJSON(`/adminxyz/unword/add/${e}/`+t,function(){alertModal(`단어 ${title}(이)가 등록되었습니다.`),$("#alertModal").on("hide.bs.modal",()=>location.reload())}).fail((e,t)=>{"parsererror"==t?(alertModal(`단어 ${title}(이)가 등록되었습니다.`),$("#alertModal").on("hide.bs.modal",()=>location.reload())):alertModal("에러가 발생했습니다.\n"+e.responseJSON.exception)})}),$(document).on("contextmenu",".input-example-eng",function(t){var n=getSelection(),l=t.target.closest(".eng"),a=n.getRangeAt(0);if(!n.isCollapsed||t.target.matches("strong")){n.isCollapsed?t.target.matches("strong")&&(t.preventDefault(),t.target.replaceWith(t.target.textContent),n.removeAllRanges()):(t.preventDefault(),n=createElement({el:"strong",textContent:a.toString()}),a.deleteContents(),a.insertNode(n)),l.childNodes.forEach(e=>{0==e.textContent.length&&e.remove()});let e=l.firstChild;for(;e;)e.previousSibling?.nodeName==e.nodeName&&(e.textContent=e.previousSibling.textContent.concat(e.textContent),e.previousSibling.remove()),e=e.nextSibling}}).on("click",".js-edit-meaning",function(){var e=$(this).closest(".one-part-unit-section"),t=e.data("sid");const n=e.find(".input-meaning"),l=e.find(".input-example-eng"),a=e.find(".input-example-kor"),s={meaning:n.val().trim()},o=0<e.closest(".showup-sense-list-section").length;o?(s.showUpId=t,s.eng=l.html().trim(),s.kor=a.val().trim()):s.senseId=t,$.ajax({url:`/adminxyz/dictionary/${o?"showup":""}sense/edit`,type:"POST",data:s,success:()=>{alertModal(`뜻이 수정되었습니다.
: `+s.meaning+(o?"\n예문:\n"+s.eng+"\n"+s.kor:"")),n.get(0).dataset.org=s.meaning,o&&(l.get(0).dataset.org=s.eng,a.get(0).dataset.org=s.kor)},error:()=>alertModal("수정이 실패했습니다.")})}).on("click",".js-edit-cancel",function(){$(this).closest(".one-part-unit-section").find("input,[contenteditable]").each(function(){this.matches("input")?$(this).val($(this).data("org")):$(this).html($(this).data("org"))}),$(this).hide(),$(this).siblings(".js-edit-meaning").hide()}).on("click",".js-add-meaning",function(){var e=$(this).closest(".add-new-sense-section"),t=e.find("select"),n=e.find("input");if(0!=n.val().trim()){const l=0<$(this).closest(".showup-word").length;t={wordId:parseInt($(this).closest(".showup-word,#searchResult").data("wordId")),partType:t.val(),meaning:n.val().trim()};l&&(t.eng=e.find(".input-example-eng").html().trim(),t.kor=e.find(".input-example-kor").val().trim()),$.ajax({url:`/adminxyz/dictionary/${l?"showup":""}sense/add`,type:"POST",data:t,success:e=>{alertModal(`뜻이 추가되었습니다.
: ${e.partType} `+e.meaning),$(".add-new-sense-label").before(createElement(a(l,e)))},error:()=>alertModal("단어 뜻을 추가하지 못 했습니다.")})}}).on("click",".js-add-cancel",function(){$(this).hide(),$(this).closest(".add-new-sense-section").find(".js-add-meaning").hide(),$(this).closest(".add-new-sense-section").find("input").val("")}).on("click",".js-del-meaning",function(){const e=$(this).closest(".one-part-unit-section");var t=parseInt(e.data("sid"));$.ajax({url:"/adminxyz/dictionary/showupsense/del",type:"POST",data:{showUpId:t},success:()=>{alertModal("뜻을 삭제했습니다."),e.remove()},error:()=>alertModal("단어 뜻을 삭제하지 못 했습니다.")})})}