!function(c,o,p){function i(t){this.options=Object.assign({},i.defaults,t),this.isDomNode(this.options.parent)||(this.options.parent=i.defaults.parent),1<this.options.opacity&&this.options.opacity<=100?this.options.opacity=this.options.opacity/100:1<this.options.opacity&&this.options.opacity<=255?this.options.opacity=this.options.opacity/255:(this.options.opacity<0||1<this.options.opacity&&255<this.options.opacity)&&(this.options.opacity=i.defaults.opacity),this.options.fadeDuration<0?this.options.fadeDuration=i.defaults.fadeDuration:this.options.fadeDuration<10&&(this.options.fadeDuration=1e3*this.options.fadeDuration),this.options.padding=parseFloat(this.options.padding)||0===parseFloat(this.options.padding)?parseFloat(this.options.padding):i.defaults.padding,this.options.borderRadius=parseFloat(this.options.borderRadius)||0===parseFloat(this.options.borderRadius)?Math.max(parseFloat(this.options.borderRadius),0):i.defaults.borderRadius,this.options.transitionDuration<0?this.options.transitionDuration=i.defaults.transitionDuration:this.options.transitionDuration<10&&(this.options.transitionDuration=1e3*this.options.transitionDuration),this.options.resizeDebounce<0?this.options.resizeDebounce=i.defaults.resizeDebounce:this.options.resizeDebounce<10&&(this.options.resizeDebounce=1e3*this.options.resizeDebounce),this.options.resizeDebounce=Math.max(this.options.resizeDebounce,100),this.options.zIndex=parseInt(this.options.zIndex)||i.defaults.zIndex,this.options.easing=["none","linear","swing","default"].indexOf(this.options.easing.trim().toLowerCase())?this.options.easing.trim().toLowerCase():i.defaults.easing,this.init()}i.defaults={parent:o.body,opacity:.5,fadeDuration:1e3,padding:5,borderRadius:5,transitionDuration:1e3,resizeDebounce:100,zIndex:99,easing:"swing"},function(){this.init=function(){this.els=[],this.rects=[],this.parent=this.options.parent,this.parentRect=this.parent.getBoundingClientRect(),this.canvas=o.createElement("canvas"),this.canvas.width=Math.max(this.parent.clientWidth,this.parent.scrollWidth),this.canvas.height=Math.max(this.parent.clientHeight,this.parent.scrollHeight),this.ctx=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.top="0px",this.canvas.style.left="0px",this.canvas.style.zIndex=this.options.zIndex,this.canvas.style.pointerEvents="none",this.canvas.style.opacity="0",c.addEventListener("resize",function(){clearTimeout(this.resizeHandle),this.resizeHandle=setTimeout(this.resize.bind(this),this.options.resizeDebounce)}.bind(this)),this.options.parent.appendChild(this.canvas),this.anims=[],this.isVisible=!1,this.resizeHandle=null,this.draw()},this.cleanup=function(){this.clear(),this.rects=[],this.els=[]},this.clear=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},this.roundedRect=function(t,i,s,e,n,o,a){if("number"==typeof(n=n||0===n?n:this.options.borderRadius))n={tl:n,tr:n,br:n,bl:n};else{var h,r={tl:this.options.borderRadius,tr:this.options.borderRadius,br:this.options.borderRadius,bl:this.options.borderRadius};for(h in r)n[h]=n[h]||r[h]}o===p&&(o=!0),this.ctx.beginPath(),this.ctx.moveTo(t+n.tl,i),this.ctx.lineTo(t+s-n.tr,i),this.ctx.quadraticCurveTo(t+s,i,t+s,i+n.tr),this.ctx.lineTo(t+s,i+e-n.br),this.ctx.quadraticCurveTo(t+s,i+e,t+s-n.br,i+e),this.ctx.lineTo(t+n.bl,i+e),this.ctx.quadraticCurveTo(t,i+e,t,i+e-n.bl),this.ctx.lineTo(t,i+n.tl),this.ctx.quadraticCurveTo(t,i,t+n.tl,i),this.ctx.closePath(),o&&this.ctx.fill(),a&&this.ctx.stroke()},this.isPercent=function(t){return/^\s*\-?(\d+\.?\d*|\d*\.\d+)%\s*$/.test(t)},this.calcPercent=function(t){return{x:this.isPercent(t.x)?this.canvas.width*parseFloat(t.x)/100:parseFloat(t.x),y:this.isPercent(t.y)?this.canvas.height*parseFloat(t.y)/100:parseFloat(t.y),width:this.isPercent(t.width)?this.canvas.width*parseFloat(t.width)/100:parseFloat(t.width),height:this.isPercent(t.height)?this.canvas.height*parseFloat(t.height)/100:parseFloat(t.height)}},this.draw=function(){this.clear(),this.ctx.globalAlpha=this.options.opacity,this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.globalAlpha=1,this.ctx.globalCompositeOperation="destination-out",this.rects.forEach(t=>{var t=this.calcPercent(t),i=Math.max(t.x-this.options.padding,0),s=Math.max(t.y-this.options.padding,0),e=Math.min(t.width+2*this.options.padding-(t.x<0?Math.abs(t.x):0),this.canvas.width-i),t=Math.min(t.height+2*this.options.padding-(t.y<0?Math.abs(t.y):0),this.canvas.height-s);this.roundedRect(i,s,e,t)}),this.ctx.globalCompositeOperation="source-over"},this.ease=function(t,i){switch(i){case"none":case"linear":return t;default:return.5-Math.cos(t*Math.PI)/2}},this.fadeOut=function(n){if(!this.isFadingOut()&&this.isVisible){let i=parseFloat(this.canvas.style.opacity)||1,s=("function"==typeof n?n={duration:this.options.fadeDuration,onComplete:n}:"number"==typeof n?n={duration:n}:"object"!=typeof n&&(n={duration:this.options.fadeDuration}),{type:"fadeOut",start:0,stop:!1}),e=(this.anims.push(s),function(t){s.start||(s.start=t);t=0==n.duration?1:this.ease(Math.min((t-s.start)/n.duration,1));this.canvas.style.opacity=(1-t)*i,0<this.canvas.style.opacity&&!s.stop?requestAnimationFrame(e):(s.stop||(this.isVisible=!1),this.removeAnim(s.start,s.type),n.onComplete&&"function"==typeof n.onComplete&&n.onComplete())}.bind(this));this.stopFadeIn(),requestAnimationFrame(e)}},this.fadeIn=function(i){let s=this.isVisible?parseFloat(this.canvas.style.opacity)||1:0;if(this.isFadingIn()||.99<=s)return!1;"function"==typeof i?i={duration:this.options.fadeDuration,onComplete:i}:"number"==typeof i?i={duration:i}:"object"!=typeof i&&(i={duration:this.options.fadeDuration}),(!i.duration&&0!==i.duration||i.duration<0)&&(i.duration=this.options.fadeDuration),i.duration<10&&(i.duration=1e3*i.duration);let e={type:"fadeIn",start:0,stop:!1,startY:c.scrollY+c.innerHeight/2,targetY:this.getAverageY()},n=(this.anims.push(e),this.isVisible=!0,function(t){e.start||(e.start=t);t=0==i.duration?1:this.ease(Math.min((t-e.start)/i.duration,1));this.canvas.style.opacity=s+t*(1-s),c.scrollTo(0,this.lerp(e.startY-c.innerHeight/2,e.targetY-c.innerHeight/2,t)),this.canvas.style.opacity<1&&!e.stop?requestAnimationFrame(n):(this.removeAnim(e.start,e.type),i.onComplete&&"function"==typeof i.onComplete&&i.onComplete())}.bind(this));this.stopFadeOut(),requestAnimationFrame(n)},this.stop=function(i,s){this.anims.filter(t=>!((i||0===i)&&t.start!=i||s&&t.type!=s)).forEach(t=>t.stop=!0)},this.stopFadeOut=function(t){this.stop(t,"fadeOut")},this.stopFadeIn=function(t){this.stop(t,"fadeIn")},this.stopTransition=function(t){this.stop(t,"transition")},this.removeAnim=function(i,s){let t=this.anims.findIndex(t=>!((i||0===i)&&t.start!=i||s&&t.type!=s));for(;0<=t;)this.anims.splice(t,1),t=this.anims.findIndex(t=>!((i||0===i)&&t.start!=i||s&&t.type!=s))},this.isFadingOut=function(){return 0<=this.anims.findIndex(t=>"fadeOut"==t.type&&!t.stop)},this.isFadingIn=function(){return 0<=this.anims.findIndex(t=>"fadeIn"==t.type&&!t.stop)},this.isTransitioning=function(){return 0<=this.anims.findIndex(t=>"transition"==t.type&&!t.stop)},this.resize=function(){!this.isVisible&&this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas),this.canvas.width=Math.max(this.parent.clientWidth,this.parent.scrollWidth),this.canvas.height=Math.max(this.parent.clientHeight,this.parent.scrollHeight),this.isVisible?this.transition():this.canvas.parentElement||this.options.parent.appendChild(this.canvas)},this.isDomNode=function(t){try{if(t instanceof HTMLElement||t instanceof SVGElement)return!0}catch(t){}return t&&"object"==typeof t&&1==t.nodeType},this.isDomNodeList=function(t){try{if(t instanceof NodeList)return!0}catch(t){}return t&&"object"==typeof t&&"NodeList"==t.constructor.name},this.isJqueryObject=function(t){if("undefined"==typeof jQuery)return!1;try{if(t instanceof jQuery)return!0}catch(t){}return t&&"object"==typeof t&&t.jquery},this.isWithinDoc=function(t){t=this.calcPercent(t);return!(t.width<=0||t.height<=0||t.x+t.width<0||t.x>this.canvas.width||t.y+t.height<0||t.y>this.canvas.height)},this.getRect=function(t){let i;return(i=this.isDomNode(t)?t.getBoundingClientRect():t.width!==p&&t.height!==p&&t)&&i.top!==p&&(i.x-=this.parentRect.x,i.y+=-this.parentRect.y+this.parent.scrollTop),i},this.getAverageY=function(){let s=0,e=0;return this.els.forEach(t=>{var t=this.calcPercent(this.getRect(t)),i=t.width*t.height;s+=(t.y+t.height/2)*i,e+=i}),s/e},this.lerp=function(t,i,s){return t+s*(i-t)},this.highlight=function(t,i){this.parentRect=this.parent.getBoundingClientRect(),t=t||[];let s=(t=Array.isArray(t)?t:[t]).length-1;for(;0<=s;)this.isDomNodeList(t[s])||this.isJqueryObject(t[s])?t=t.slice(0,s).concat(Array.from(t[s])).concat(t.slice(s+1)):"string"==typeof t[s]?t=t.slice(0,s).concat(Array.from(o.querySelectorAll(t[s]))).concat(t.slice(s+1)):!this.isDomNode(t[s])&&(!t[s]||0<!t[s].width||0<!t[s].height)&&t.splice(s,1),s--;var e={add:!1,duration:this.options.transitionDuration,easing:this.options.easing};"boolean"==typeof i?i={add:i}:"number"==typeof i?i={duration:i}:"function"==typeof i?i={onComplete:i}:"object"!=typeof i&&(i={}),i=Object.assign(e,i),t=t.filter(t=>{t=this.getRect(t);return this.isWithinDoc(t)}),i.add?this.els=this.els.concat(t):this.els=t;let n=this;this.isVisible?(this.isFadingOut()&&this.fadeIn(),this.transition({duration:i.duration,onComplete:i.onComplete,easing:i.easing})):(this.resize(),this.transition({duration:0,onComplete:function(){n.fadeIn({onComplete:i.onComplete})},easing:i.easing}))},this.rehighlight=function(t){"boolean"==typeof t?t={add:t}:"number"==typeof t?t={duration:t}:"function"==typeof t?t={onComplete:t}:"object"!=typeof t&&(t={}),t.add=!0,this.highlight(!1,t)},this.transition=function(i){var t={duration:this.options.transitionDuration,easing:this.options.easing};for("number"==typeof i?i={duration:i}:"boolean"==typeof i?i={follow:i}:"function"==typeof i?i={onComplete:i}:"object"!=typeof i&&(i={}),(!(i=Object.assign(t,i)).duration&&0!==i.duration||i.duration<0)&&(i.duration=this.options.transitionDuration),i.duration<10&&(i.duration=1e3*i.duration),"none"!=i.easing&&"linear"!=i.easing||(i.easing=!1),this.stopTransition();this.rects.length<this.els.length;)this.rects.push({x:this.canvas.width/2-this.options.padding,y:2*-this.options.padding,width:-2*this.options.padding,height:-2*this.options.padding});let n=[],o=(this.parentRect=this.parent.getBoundingClientRect(),this.rects.forEach((t,i)=>{i=this.els.length>i?this.calcPercent(this.getRect(this.els[i])):{x:this.canvas.width/2-this.options.padding,y:2*-this.options.padding,width:-2*this.options.padding,height:-2*this.options.padding};n.push(i)}),[]),s=(this.rects.forEach((s,e)=>{n.forEach((t,i)=>{t=Math.pow(s.x-t.x,2)+Math.pow(s.y-t.y,2);o.push({from:e,to:i,dist:t})})}),o.sort((t,i)=>t.dist-i.dist),[]),e=[],a=[],h=(this.rects.forEach(()=>{s.push(!1),e.push(!1),a.push(-1)}),o.forEach(t=>{s[t.from]||e[t.to]||(s[t.from]=e[t.to]=!0,a[t.from]=t.to)}),[]),r=(a.forEach(t=>{h.push(n[t])}),{type:"transition",start:0,stop:!1,startRects:this.rects.slice(0),targetRects:h,startY:c.scrollY+c.innerHeight/2,targetY:this.getAverageY()});this.anims.push(r);var p=function(t){r.start||(r.start=t);let n=0==i.duration?1:Math.min((t-r.start)/i.duration,1);i.easing&&(n=this.ease(n)),r.stop||(this.rects.forEach((t,i,s)=>{var e=r.targetRects[i];s[i].x=this.lerp(r.startRects[i].x,e.x,n),s[i].y=this.lerp(r.startRects[i].y,e.y,n),s[i].width=this.lerp(r.startRects[i].width,e.width,n),s[i].height=this.lerp(r.startRects[i].height,e.height,n)}),0<i.duration&&c.scrollTo(0,this.lerp(r.startY-c.innerHeight/2,r.targetY-c.innerHeight/2,n)),this.draw(),n<1&&requestAnimationFrame(p)),(r.stop||1<=n)&&(r.stop||(this.rects=this.rects.filter(this.isWithinDoc.bind(this)),this.draw()),this.removeAnim(r.start,r.type),i.onComplete&&"function"==typeof i.onComplete&&i.onComplete())}.bind(this);requestAnimationFrame(p)}}.call(i.prototype),c.Dimmer=i}(this,this.document);